import{c as _,r as f,b as m,j as e,L as N,C as k,f as $}from"./vendor.fb93b9f7.js";import{h as w,d as P,i as j,F as x,S as L,L as R,a as S,p as D,s as A,b as C}from"./index.5b36a761.js";const I="_discovery_1ng19_1";var E={discovery:I};const F="_carousel_12lx8_1";var z={carousel:F};function B({data:s}){const u=s.length,i=_(),[c,r]=f.exports.useState(0),[n,y]=f.exports.useState(!0),o=j(y,5e3);w(()=>{r((c+1)%u)},n?5e3:null);const l=a=>{const t=a-c,g=t>0?t-u:t+u,v=Math.abs(t)>Math.abs(g)?g:t,d={};return v===0?(d.left="33.3%",d.zIndex=999,d.opacity=1,d.transform="scale(1)"):d.left=v>0?`${16.7+v*40}%`:`${50+v*40}%`,Math.abs(v)>=2&&(d.opacity=0,d.transform="scale(0)"),d},p=(a,t,g,v)=>{if(c===a)switch(g){case 1:i(`/Song?id=${t}`);break;case 10:i(`/Album?id=${t}`);break;case 1e3:i(`SongList?id=${t}`);break;case 1004:i(`/Video?id=${t}`);break;case 3e3:window.open(v);break;default:return}else h(a)},h=a=>{r(a),y(!1),o(!0)};return m("div",{className:z.carousel,children:[e("div",{className:"card-container",children:s.map(({imageUrl:a,targetId:t,targetType:g,url:v},d)=>e("div",{className:"card",onClick:()=>p(d,t,g,v),style:l(d),children:e("img",{src:`${P(a)}?param=500y200`})},d))}),e("div",{className:"rects",children:s.map((a,t)=>e("div",{className:c===t?"rect-active":"rect",onClick:()=>h(t)},t))})]})}var M={"recommend-playlist":"_recommend-playlist_e8uj7_1"};const O=s=>s>=1e4?`${s*1e-4>>0} \u4E07`:s;function H({data:s,onPlayAll:u}){const i=(r,n)=>{r.preventDefault(),u(n)},c=r=>e("div",{className:"playlist",children:r.map(({id:n,name:y,copywriter:o,picUrl:l,playCount:p})=>m("div",{className:"listitem",children:[m(N,{className:"image",to:`/Playlist?id=${n}`,children:[e("img",{src:`${P(l)}?param=240y240`,loading:"lazy"}),e("div",{className:"copywriter",children:o}),m("div",{className:"play-count",children:[e(k,{}),O(p)]}),e("div",{className:"play-button",onClick:h=>i(h,n),children:e($,{})})]}),e(N,{className:"description",to:`/Playlist?id=${n}`,children:y})]},n))});return m("div",{className:M["recommend-playlist"],children:[c(s.slice(0,5)),c(s.slice(5,10))]})}var b={"recent-songlist":"_recent-songlist_1wgos_1"};function V({data:s}){const{playSong:u,setPlaylist:i}=f.exports.useContext(x),{playlist:c}=f.exports.useContext(L),r=(y,o)=>{y.preventDefault();const l=s[o],p=c.slice();p.push(l),i(p),u(l)},n=(y,o)=>y.map(({id:l,name:p,cover:h,singers:a},t)=>m("div",{className:"item",children:[e("div",{className:"order",children:(t+1+o).toString().padStart(2,"0")}),m(N,{className:"image",to:`/Song?id=${l}`,children:[e("img",{src:`${h}?param=50y50`,loading:"lazy"}),e("div",{className:"play-button",onClick:g=>r(g,t+o),children:e($,{})})]}),m("div",{className:"information",children:[e(N,{className:"song-title",to:`/Song?id=${l}`,children:p}),e("div",{className:"singer",children:a.map(({name:g})=>g).join("/")})]})]},l));return m("div",{className:b["recent-songlist"],children:[e("div",{className:b.left,children:n(s.slice(0,5),0)}),e("div",{className:b.right,children:n(s.slice(5,10),5)})]})}function K({pageState:s,onPlayAll:u}){if(!s)return e(R,{});const{banner:i,recommendPlaylist:c,recentSong:r}=s;return m("div",{className:E.discovery,children:[e("div",{className:"banner",children:e(B,{data:i})}),m("div",{children:[e("div",{className:"title",children:"\u63A8\u8350\u6B4C\u5355"}),e(H,{data:c,onPlayAll:u})]}),m("div",{children:[e("div",{className:"title",children:"\u6700\u65B0\u97F3\u4E50"}),e(V,{data:r})]})]})}const T=()=>S("/banner"),q=(s=10)=>S(`/personalized?limit=${s}`),G=(s=0)=>S(`/top/song?type=${s}`);function U(){const[s,u]=f.exports.useState(null),{setPlaylist:i,playSong:c}=f.exports.useContext(x),r=async n=>{const o=(await D(n)).playlist.trackIds.map(a=>a.id),l=await A(o),p=C(l.songs,"detail"),h=p.filter(a=>a.isFree);i(h),c(p[0])};return f.exports.useEffect(()=>{document.title="\u53D1\u73B0\u97F3\u4E50"},[]),f.exports.useEffect(()=>{(async()=>{const y=await T(),o=await q(),l=await G();u({banner:y.banners,recommendPlaylist:o.result,recentSong:C(l.data,"topSong")})})()},[]),e(K,{pageState:s,onPlayAll:r})}export{U as default};
