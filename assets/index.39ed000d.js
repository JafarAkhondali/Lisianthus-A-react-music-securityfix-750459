var Et=Object.defineProperty,Ft=Object.defineProperties;var It=Object.getOwnPropertyDescriptors;var We=Object.getOwnPropertySymbols;var Dt=Object.prototype.hasOwnProperty,$t=Object.prototype.propertyIsEnumerable;var Te=(e,n,t)=>n in e?Et(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,B=(e,n)=>{for(var t in n||(n={}))Dt.call(n,t)&&Te(e,t,n[t]);if(We)for(var t of We(n))$t.call(n,t)&&Te(e,t,n[t]);return e},j=(e,n)=>Ft(e,It(n));var T=(e,n,t)=>(Te(e,typeof n!="symbol"?n+"":n,t),t);import{r as h,u as ke,a as Ge,j as d,M as Be,b,F as Ce,I as Le,B as Xe,c as Ye,S as Ke,L as Q,A as Mt,U as Pt,C as Tt,H as kt,G as Bt,d as Lt,e as Rt,P as Ot,f as Qe,g as jt,h as zt,D as Ze,i as Ut,k as Vt,l as Ht,m as qt,R as Wt,n as Gt,o as Xt,T as Yt,p as Je,q as Re,s as Kt,t as Qt}from"./vendor.fb93b9f7.js";const Zt=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerpolicy&&(l.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?l.credentials="include":s.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}};Zt();const et=(e,n)=>{const t=h.exports.useRef(()=>{});h.exports.useEffect(()=>{t.current=e},[e]),h.exports.useEffect(()=>{if(n!==null){const o=setInterval(()=>t.current(),n);return()=>clearInterval(o)}},[n])},Jt=(e={})=>{const[n,t]=h.exports.useState(e),o=h.exports.useCallback(s=>{t(l=>Object.assign({},l,s instanceof Function?s(l):s))},[]);return[n,o]},ks=e=>{const{search:n}=ke(),t=new RegExp(`[?&]${e}=([\\w%]+)`),o=n.match(t);return o?o[1]:null},en="https://server0309.herokuapp.com",tn={method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0},M=async(e,n={})=>(await Ge(B(B({url:en+e},tn),n))).data,nn=30;class sn{constructor(){T(this,"cacheIds");T(this,"cache");this.cacheIds=[],this.cache=new Map}save(n,t){const{cache:o,cacheIds:s}=this;if(s.length>=nn){const l=s.shift();o.delete(l)}o.set(n,t)}get(n){return this.cache.get(n)||null}del(n){const{cache:t,cacheIds:o}=this,s=o.findIndex(l=>l===n);s!==-1&&(o.splice(s,1),t.delete(n))}delAll(){const{cache:n}=this;n.clear(),this.cacheIds=[]}}var Se=(()=>{let e;return()=>e||(e=new sn)})();const Bs=e=>M(`/comment/music?id=${e}`),an=e=>M(`/song/detail?ids=${e.join()}`),rn=async e=>M(`/lyric?id=${e}`),on=()=>{const e=Number(localStorage.getItem("timestampBefore"));if(Date.now()>=e)return localStorage.removeItem("timestampBefore"),localStorage.removeItem("token"),!1;const n=localStorage.getItem("token");return Boolean(n)},_e=e=>{const n=e/60>>0,t=e%60>>0;return`${n.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},Ls=e=>{const n=Date.now()-e,t=new Date(n);return n<=6e4?"\u521A\u521A":n<=36e5?`${n/6e4>>0} \u5206\u949F\u524D`:n<=864e5?`${n/36e5>>0} \u5C0F\u65F6\u524D`:t.getFullYear()>1970?`${t.getFullYear()-1970} \u5E74\u524D`:t.getMonth()?`${t.getMonth()} \u6708\u524D`:`${t.getDate()-1} \u5929\u524D`},ln=(e,n)=>{let t;return function(...o){clearTimeout(t),t=setTimeout(()=>{e.call(this,...o)},n)}},z=e=>e.replace(/http\:/,"https:"),cn=e=>{const[n,t,o]=e.match(/\d+/g);return Number(n)*60+Number(t)+Number(o)*.001},un=e=>{var r,u;const{uncollected:n,nolyric:t,lrc:o,tlyric:s}=e;if(n||t)return[];const l=o.lyric.split(`
`).filter(m=>/\d+\:\d+[\.\:]\d+/.test(m)),i=((u=(r=s==null?void 0:s.lyric)==null?void 0:r.split(`
`))==null?void 0:u.filter(m=>/\d+\:\d+[\.\:]\d+/.test(m)))||[],a=(m,p)=>{const C=m.lastIndexOf("]"),f=m.slice(C+1);m.match(/\d+\:\d+[\.\:]\d+/g).forEach(w=>{const x=cn(w);p?c[x]=[f,"",x]:c[x]&&(c[x][1]=f)})},c={};return l.forEach(m=>a(m,!0)),i.forEach(m=>a(m,!1)),Object.values(c).sort((m,p)=>m[2]-p[2])},dn=(e,n)=>e.map(t=>{const{id:o,name:s}=t,l=["topSong","fm","search"].includes(n)?t.album:t.al,i=n==="detail"?t.ar:t.artists,a=["simiSong","fm","search"].includes(n)?t.duration:t.dt,c=t.fee!==1;return{id:o,name:s,isFree:c,duration:a*.001,singers:i.map(({id:r,name:u})=>({id:r,name:u})),albumId:l.id,albumName:l.name,cover:z(l.picUrl||"")}}),Rs=e=>{const n=e.hasOwnProperty("playlist"),t=e.hasOwnProperty("album"),o=!n&&!t;if(n){const{name:s,tags:l,description:i,createTime:a}=e.playlist,c=z(e.playlist.coverImgUrl),r={id:e.playlist.creator.userId,name:e.playlist.creator.nickname,avatar:z(e.playlist.creator.avatarUrl),createTime:a},u=Number(localStorage.getItem("userid"))===r.id;return{isPlaylist:n,isAlbum:t,isSong:o,title:s,cover:c,creator:r,isCreator:u,tags:l,description:i}}else if(t){const{name:s,publishTime:l,description:i}=e.album,a=e.album.artists.map(({id:r,name:u})=>({id:r,name:u})),c=z(e.album.picUrl);return{isPlaylist:n,isAlbum:t,isSong:o,title:s,cover:c,singers:a,publishTime:l,description:i}}else{const{name:s,al:{id:l,name:i}}=e.songs[0],a=e.songs[0].ar.map(({id:r,name:u})=>({id:r,name:u})),c=z(e.songs[0].al.picUrl);return{isPlaylist:n,isAlbum:t,isSong:o,title:s,cover:c,singers:a,albumId:l,albumName:i}}};var mn=function(e){function n(o){if(t[o])return t[o].exports;var s=t[o]={i:o,l:!1,exports:{}};return e[o].call(s.exports,s,s.exports,n),s.l=!0,s.exports}var t={};return n.m=e,n.c=t,n.i=function(o){return o},n.d=function(o,s,l){n.o(o,s)||Object.defineProperty(o,s,{configurable:!1,enumerable:!0,get:l})},n.n=function(o){var s=o&&o.__esModule?function(){return o.default}:function(){return o};return n.d(s,"a",s),s},n.o=function(o,s){return Object.prototype.hasOwnProperty.call(o,s)},n.p="",n(n.s=0)}([function(e,n,t){function o(s){if(this.size=0|s,this.size<=1||(this.size&this.size-1)!=0)throw new Error("FFT size must be a power of two and bigger than 1");this._csize=s<<1;for(var l=new Array(2*this.size),i=0;i<l.length;i+=2){var a=Math.PI*i/this.size;l[i]=Math.cos(a),l[i+1]=-Math.sin(a)}this.table=l;for(var c=0,r=1;this.size>r;r<<=1)c++;this._width=c%2==0?c-1:c,this._bitrev=new Array(1<<this._width);for(var u=0;u<this._bitrev.length;u++){this._bitrev[u]=0;for(var m=0;m<this._width;m+=2){var p=this._width-m-2;this._bitrev[u]|=(u>>>m&3)<<p}}this._out=null,this._data=null,this._inv=0}e.exports=o,o.prototype.fromComplexArray=function(s,l){for(var i=l||new Array(s.length>>>1),a=0;a<s.length;a+=2)i[a>>>1]=s[a];return i},o.prototype.createComplexArray=function(){for(var s=new Array(this._csize),l=0;l<s.length;l++)s[l]=0;return s},o.prototype.toComplexArray=function(s,l){for(var i=l||this.createComplexArray(),a=0;a<i.length;a+=2)i[a]=s[a>>>1],i[a+1]=0;return i},o.prototype.completeSpectrum=function(s){for(var l=this._csize,i=l>>>1,a=2;a<i;a+=2)s[l-a]=s[a],s[l-a+1]=-s[a+1]},o.prototype.transform=function(s,l){if(s===l)throw new Error("Input and output buffers must be different");this._out=s,this._data=l,this._inv=0,this._transform4(),this._out=null,this._data=null},o.prototype.realTransform=function(s,l){if(s===l)throw new Error("Input and output buffers must be different");this._out=s,this._data=l,this._inv=0,this._realTransform4(),this._out=null,this._data=null},o.prototype.inverseTransform=function(s,l){if(s===l)throw new Error("Input and output buffers must be different");this._out=s,this._data=l,this._inv=1,this._transform4();for(var i=0;i<s.length;i++)s[i]/=this.size;this._out=null,this._data=null},o.prototype._transform4=function(){var s,l,i=this._out,a=this._csize,c=this._width,r=1<<c,u=a/r<<1,m=this._bitrev;if(u===4)for(s=0,l=0;s<a;s+=u,l++){var p=m[l];this._singleTransform2(s,p,r)}else for(s=0,l=0;s<a;s+=u,l++){var C=m[l];this._singleTransform4(s,C,r)}var f=this._inv?-1:1,g=this.table;for(r>>=2;r>=2;r>>=2){u=a/r<<1;var w=u>>>2;for(s=0;s<a;s+=u)for(var x=s+w,v=s,y=0;v<x;v+=2,y+=r){var _=v,N=_+w,A=N+w,S=A+w,E=i[_],P=i[_+1],k=i[N],L=i[N+1],V=i[A],H=i[A+1],q=i[S],W=i[S+1],G=E,X=P,Y=g[y],K=f*g[y+1],re=k*Y-L*K,oe=k*K+L*Y,ie=g[2*y],le=f*g[2*y+1],ce=V*ie-H*le,ue=V*le+H*ie,de=g[3*y],me=f*g[3*y+1],he=q*de-W*me,pe=q*me+W*de,fe=G+ce,J=X+ue,ee=G-ce,ge=X-ue,ve=re+he,te=oe+pe,ne=f*(re-he),ye=f*(oe-pe),be=fe+ve,Ee=J+te,Fe=fe-ve,Ie=J-te,De=ee+ye,$e=ge-ne,Me=ee-ye,Pe=ge+ne;i[_]=be,i[_+1]=Ee,i[N]=De,i[N+1]=$e,i[A]=Fe,i[A+1]=Ie,i[S]=Me,i[S+1]=Pe}}},o.prototype._singleTransform2=function(s,l,i){var a=this._out,c=this._data,r=c[l],u=c[l+1],m=c[l+i],p=c[l+i+1],C=r+m,f=u+p,g=r-m,w=u-p;a[s]=C,a[s+1]=f,a[s+2]=g,a[s+3]=w},o.prototype._singleTransform4=function(s,l,i){var a=this._out,c=this._data,r=this._inv?-1:1,u=2*i,m=3*i,p=c[l],C=c[l+1],f=c[l+i],g=c[l+i+1],w=c[l+u],x=c[l+u+1],v=c[l+m],y=c[l+m+1],_=p+w,N=C+x,A=p-w,S=C-x,E=f+v,P=g+y,k=r*(f-v),L=r*(g-y),V=_+E,H=N+P,q=A+L,W=S-k,G=_-E,X=N-P,Y=A-L,K=S+k;a[s]=V,a[s+1]=H,a[s+2]=q,a[s+3]=W,a[s+4]=G,a[s+5]=X,a[s+6]=Y,a[s+7]=K},o.prototype._realTransform4=function(){var s,l,i=this._out,a=this._csize,c=this._width,r=1<<c,u=a/r<<1,m=this._bitrev;if(u===4)for(s=0,l=0;s<a;s+=u,l++){var p=m[l];this._singleRealTransform2(s,p>>>1,r>>>1)}else for(s=0,l=0;s<a;s+=u,l++){var C=m[l];this._singleRealTransform4(s,C>>>1,r>>>1)}var f=this._inv?-1:1,g=this.table;for(r>>=2;r>=2;r>>=2){u=a/r<<1;var w=u>>>1,x=w>>>1,v=x>>>1;for(s=0;s<a;s+=u)for(var y=0,_=0;y<=v;y+=2,_+=r){var N=s+y,A=N+x,S=A+x,E=S+x,P=i[N],k=i[N+1],L=i[A],V=i[A+1],H=i[S],q=i[S+1],W=i[E],G=i[E+1],X=P,Y=k,K=g[_],re=f*g[_+1],oe=L*K-V*re,ie=L*re+V*K,le=g[2*_],ce=f*g[2*_+1],ue=H*le-q*ce,de=H*ce+q*le,me=g[3*_],he=f*g[3*_+1],pe=W*me-G*he,fe=W*he+G*me,J=X+ue,ee=Y+de,ge=X-ue,ve=Y-de,te=oe+pe,ne=ie+fe,ye=f*(oe-pe),be=f*(ie-fe),Ee=J+te,Fe=ee+ne,Ie=ge+be,De=ve-ye;if(i[N]=Ee,i[N+1]=Fe,i[A]=Ie,i[A+1]=De,y!==0){if(y!==v){var $e=ge,Me=-ve,Pe=J,gt=-ee,vt=-f*be,yt=-f*ye,_t=-f*ne,wt=-f*te,bt=$e+vt,Ct=Me+yt,St=Pe+wt,xt=gt-_t,He=s+x-y,qe=s+w-y;i[He]=bt,i[He+1]=Ct,i[qe]=St,i[qe+1]=xt}}else{var Nt=J-te,At=ee-ne;i[S]=Nt,i[S+1]=At}}}},o.prototype._singleRealTransform2=function(s,l,i){var a=this._out,c=this._data,r=c[l],u=c[l+i],m=r+u,p=r-u;a[s]=m,a[s+1]=0,a[s+2]=p,a[s+3]=0},o.prototype._singleRealTransform4=function(s,l,i){var a=this._out,c=this._data,r=this._inv?-1:1,u=2*i,m=3*i,p=c[l],C=c[l+i],f=c[l+u],g=c[l+m],w=p+f,x=p-f,v=C+g,y=r*(C-g),_=w+v,N=x,A=-y,S=w-v,E=x,P=y;a[s]=_,a[s+1]=0,a[s+2]=N,a[s+3]=A,a[s+4]=S,a[s+5]=0,a[s+6]=E,a[s+7]=P}}]);const se=512,tt=.08,nt=.8,st=se/2+1,Z=new Array(st).fill(0),hn=e=>.54-.46*Math.cos(6.283185307179586*e/(se-1)),pn=e=>{const n=new mn(se),t=n.createComplexArray();n.realTransform(t,e);for(let o=0;o<st;++o){const s=t[2*o],l=t[2*o+1],i=(s**2+l**2)**.5,a=Math.log10(i)*20;if(!isFinite(a)){Z[o]=0;continue}a<Z[o]?Z[o]=a*tt+Z[o]*(1-tt):Z[o]=a*nt+Z[o]*(1-nt)}};function fn(e){const n=e.getChannelData(0),o=R().getCurrentTime()/e.duration*n.length>>0,s=n.slice(o,o+se),l=se-s.length;for(let i=0;i<l;++i)s[s.length]=0;for(let i=0;i<se;++i){const a=hn(i);s[i]*=a}return pn(s),Z.map(i=>i?(i+20)*.0125:0)}const Oe=900,xe=310;class gn{constructor(){T(this,"onEnded");T(this,"startTime");T(this,"playingItem");T(this,"rejectFn");T(this,"audioContext");T(this,"gainNode");T(this,"reqId");T(this,"canvasContext");T(this,"currentSource");this.audioContext=new AudioContext,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination),this.canvasContext=null,this.currentSource=null,this.onEnded=null,this.startTime=!1,this.playingItem=null,this.rejectFn=()=>{},this.reqId=0,this.drawCanvas=this.drawCanvas.bind(this),console.info("musicInstance",this)}drawCanvas(){this.reqId=requestAnimationFrame(this.drawCanvas);const{canvasContext:n,playingItem:t}=this;if(!t)return;const o=fn(t.abuffer);n.clearRect(0,0,Oe,xe);const s=Oe/o.length;for(let l=0;l<o.length;++l){const i=o[l]*xe,a=l*s,c=xe-i;n.fillRect(a,c,s,i)}}getMusic(n){return new Promise((t,o)=>{var i,a;const{audioContext:s}=this;if(this.rejectFn=o,n===((a=(i=this.playingItem)==null?void 0:i.info)==null?void 0:a.id)){t(this.playingItem);return}const l=Se().get(n);if(l){s.decodeAudioData(l.buffer.slice(0)).then(c=>{t(j(B({},l),{abuffer:c}))});return}M(`/getMusicUrl?id=${n}`).then(c=>{var m;if(c.error||((m=c.url)==null?void 0:m.includes("music.163.com/404"))){t(null);return}const{url:r}=c,u=Ge({url:z(r),responseType:"arraybuffer"}).then(p=>p.data).catch(p=>null);Promise.all([u,an([n]),rn(n)]).then(([p,C,f])=>{if(p===null){console.log("get music fail, id:",n),t(null);return}const g=dn(C.songs,"detail")[0],w=un(f),x={buffer:p,info:j(B({},g),{lyric:w})};Se().save(n,x),s.decodeAudioData(p.slice(0)).then(v=>{x.info.duration=v.duration,t(j(B({},x),{abuffer:v}))})})})})}async restart(){return await this.audioContext.resume(),!0}async play(n,t){const{currentSource:o,audioContext:s,gainNode:l,playingItem:i,rejectFn:a}=this;if(a(),s.state==="suspended"&&(this.restart(),i&&i.info.id===n&&t===void 0))return!0;this.startTime=!1,o&&(o.onended=null,o.stop(0),o.disconnect());const c=await this.getMusic(n).catch(u=>null);if(!c)return!1;const r=s.createBufferSource();return r.buffer=c.abuffer,r.connect(l),this.currentSource=r,this.startTime=s.currentTime-(t||0),r.start(s.currentTime,t||0),this.playingItem=c,r.onended=()=>{this.startTime=!1,this.onEnded&&this.onEnded()},!0}async pause(){return await this.audioContext.suspend(),!0}setVolume(n){this.gainNode.gain.value=n}drawStart(){cancelAnimationFrame(this.reqId),this.reqId=requestAnimationFrame(this.drawCanvas)}drawStop(){this.canvasContext.clearRect(0,0,Oe,xe),cancelAnimationFrame(this.reqId)}setCanvasContext(n){n.fillStyle="#6dccff",this.canvasContext=n}async download(n,t){const o=await this.getMusic(n);if(!o)return!1;const s=new Blob([o.buffer]),l=URL.createObjectURL(s),i=document.createElement("a");return i.href=l,i.download=`${t}.mp3`,i.click(),URL.revokeObjectURL(l),!0}setOnEnded(n){this.onEnded=n}getCurrentTime(){const{audioContext:n,startTime:t}=this;return t!==!1?n.currentTime-t:0}getPlayingItem(){return this.playingItem.info}}var R=(()=>{let e;return()=>e||(e=new gn)})();const vn="_layout_1k0ru_1",yn="_top_1k0ru_5",_n="_middle_1k0ru_8",wn="_left_1k0ru_13",bn="_right_1k0ru_16",Cn="_bottom_1k0ru_35";var ae={layout:vn,top:yn,middle:_n,left:wn,right:bn,bottom:Cn};const Sn="_header_o9m17_1";var xn={header:Sn};function U(e,n){var t=(e&65535)+(n&65535),o=(e>>16)+(n>>16)+(t>>16);return o<<16|t&65535}function Nn(e,n){return e<<n|e>>>32-n}function Ne(e,n,t,o,s,l){return U(Nn(U(U(n,e),U(o,l)),s),t)}function F(e,n,t,o,s,l,i){return Ne(n&t|~n&o,e,n,s,l,i)}function I(e,n,t,o,s,l,i){return Ne(n&o|t&~o,e,n,s,l,i)}function D(e,n,t,o,s,l,i){return Ne(n^t^o,e,n,s,l,i)}function $(e,n,t,o,s,l,i){return Ne(t^(n|~o),e,n,s,l,i)}function Ae(e,n){e[n>>5]|=128<<n%32,e[(n+64>>>9<<4)+14]=n;var t,o,s,l,i,a=1732584193,c=-271733879,r=-1732584194,u=271733878;for(t=0;t<e.length;t+=16)o=a,s=c,l=r,i=u,a=F(a,c,r,u,e[t],7,-680876936),u=F(u,a,c,r,e[t+1],12,-389564586),r=F(r,u,a,c,e[t+2],17,606105819),c=F(c,r,u,a,e[t+3],22,-1044525330),a=F(a,c,r,u,e[t+4],7,-176418897),u=F(u,a,c,r,e[t+5],12,1200080426),r=F(r,u,a,c,e[t+6],17,-1473231341),c=F(c,r,u,a,e[t+7],22,-45705983),a=F(a,c,r,u,e[t+8],7,1770035416),u=F(u,a,c,r,e[t+9],12,-1958414417),r=F(r,u,a,c,e[t+10],17,-42063),c=F(c,r,u,a,e[t+11],22,-1990404162),a=F(a,c,r,u,e[t+12],7,1804603682),u=F(u,a,c,r,e[t+13],12,-40341101),r=F(r,u,a,c,e[t+14],17,-1502002290),c=F(c,r,u,a,e[t+15],22,1236535329),a=I(a,c,r,u,e[t+1],5,-165796510),u=I(u,a,c,r,e[t+6],9,-1069501632),r=I(r,u,a,c,e[t+11],14,643717713),c=I(c,r,u,a,e[t],20,-373897302),a=I(a,c,r,u,e[t+5],5,-701558691),u=I(u,a,c,r,e[t+10],9,38016083),r=I(r,u,a,c,e[t+15],14,-660478335),c=I(c,r,u,a,e[t+4],20,-405537848),a=I(a,c,r,u,e[t+9],5,568446438),u=I(u,a,c,r,e[t+14],9,-1019803690),r=I(r,u,a,c,e[t+3],14,-187363961),c=I(c,r,u,a,e[t+8],20,1163531501),a=I(a,c,r,u,e[t+13],5,-1444681467),u=I(u,a,c,r,e[t+2],9,-51403784),r=I(r,u,a,c,e[t+7],14,1735328473),c=I(c,r,u,a,e[t+12],20,-1926607734),a=D(a,c,r,u,e[t+5],4,-378558),u=D(u,a,c,r,e[t+8],11,-2022574463),r=D(r,u,a,c,e[t+11],16,1839030562),c=D(c,r,u,a,e[t+14],23,-35309556),a=D(a,c,r,u,e[t+1],4,-1530992060),u=D(u,a,c,r,e[t+4],11,1272893353),r=D(r,u,a,c,e[t+7],16,-155497632),c=D(c,r,u,a,e[t+10],23,-1094730640),a=D(a,c,r,u,e[t+13],4,681279174),u=D(u,a,c,r,e[t],11,-358537222),r=D(r,u,a,c,e[t+3],16,-722521979),c=D(c,r,u,a,e[t+6],23,76029189),a=D(a,c,r,u,e[t+9],4,-640364487),u=D(u,a,c,r,e[t+12],11,-421815835),r=D(r,u,a,c,e[t+15],16,530742520),c=D(c,r,u,a,e[t+2],23,-995338651),a=$(a,c,r,u,e[t],6,-198630844),u=$(u,a,c,r,e[t+7],10,1126891415),r=$(r,u,a,c,e[t+14],15,-1416354905),c=$(c,r,u,a,e[t+5],21,-57434055),a=$(a,c,r,u,e[t+12],6,1700485571),u=$(u,a,c,r,e[t+3],10,-1894986606),r=$(r,u,a,c,e[t+10],15,-1051523),c=$(c,r,u,a,e[t+1],21,-2054922799),a=$(a,c,r,u,e[t+8],6,1873313359),u=$(u,a,c,r,e[t+15],10,-30611744),r=$(r,u,a,c,e[t+6],15,-1560198380),c=$(c,r,u,a,e[t+13],21,1309151649),a=$(a,c,r,u,e[t+4],6,-145523070),u=$(u,a,c,r,e[t+11],10,-1120210379),r=$(r,u,a,c,e[t+2],15,718787259),c=$(c,r,u,a,e[t+9],21,-343485551),a=U(a,o),c=U(c,s),r=U(r,l),u=U(u,i);return[a,c,r,u]}function at(e){var n,t="",o=e.length*32;for(n=0;n<o;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}function je(e){var n,t=[];for(t[(e.length>>2)-1]=void 0,n=0;n<t.length;n+=1)t[n]=0;var o=e.length*8;for(n=0;n<o;n+=8)t[n>>5]|=(e.charCodeAt(n/8)&255)<<n%32;return t}function An(e){return at(Ae(je(e),e.length*8))}function En(e,n){var t,o=je(e),s=[],l=[],i;for(s[15]=l[15]=void 0,o.length>16&&(o=Ae(o,e.length*8)),t=0;t<16;t+=1)s[t]=o[t]^909522486,l[t]=o[t]^1549556828;return i=Ae(s.concat(je(n)),512+n.length*8),at(Ae(l.concat(i),512+128))}function rt(e){var n="0123456789abcdef",t="",o,s;for(s=0;s<e.length;s+=1)o=e.charCodeAt(s),t+=n.charAt(o>>>4&15)+n.charAt(o&15);return t}function ze(e){return unescape(encodeURIComponent(e))}function ot(e){return An(ze(e))}function Fn(e){return rt(ot(e))}function it(e,n){return En(ze(e),ze(n))}function In(e,n){return rt(it(e,n))}function lt(e,n,t){return n?t?it(n,e):In(n,e):t?ot(e):Fn(e)}const Dn=(e,n)=>M(`/login?email=${e}&md5_password=${lt(n)}`,{method:"POST"}),$n=(e,n)=>M(`/login/cellphone?phone=${e}&md5_password=${lt(n)}`,{method:"POST"}),Mn=()=>M("/logout"),Pn={labelCol:{span:4},wrapperCol:{span:20}},Tn={wrapperCol:{offset:18,span:4}};function kn({onCancel:e,setUserInfo:n}){const[t,o]=h.exports.useState(!1),s=async l=>{const{username:i,password:a}=l;if(!i||!a)return;let c;if(/^[\w-.]+@[\w-.]+\.\w+$/.test(i))c="email";else if(/^1[3-9]\d{9}$/.test(i))c="phone";else return;if(t)return;o(!0);const r=c==="email"?await Dn(i,a):await $n(i,a);window.localStorage.setItem("username",r.profile.nickname),window.localStorage.setItem("avatar",z(r.profile.avatarUrl)),window.localStorage.setItem("userid",r.account.id),window.localStorage.setItem("token",r.token);const u=Number(r.cookie.match(/MUSIC_U=\w+;\s?Max-Age=(\d+)/)[1]);window.localStorage.setItem("timestampBefore",String(Date.now()+u*1e3)),n({name:r.profile.nickname,avatar:z(r.profile.avatarUrl)}),e()};return d(Be,{title:"\u767B\u5F55",visible:!0,onCancel:e,footer:null,children:b(Ce,j(B({},Pn),{onFinish:s,children:[d(Ce.Item,{label:"\u8D26\u53F7",name:"username",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D26\u53F7"}],children:d(Le,{placeholder:"\u8F93\u5165\u624B\u673A\u53F7\u6216\u90AE\u7BB1"})}),d(Ce.Item,{label:"\u5BC6\u7801",name:"password",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"}],children:d(Le,{type:"password",placeholder:"\u8F93\u5165\u5BC6\u7801",autoComplete:"on"})}),d(Ce.Item,j(B({},Tn),{children:d(Xe,{type:"primary",htmlType:"submit",loading:t,children:"\u767B\u5F55"})}))]}))})}const Bn=e=>M(`/search/suggest?keywords=${e}`),Os=(e,n,t)=>M(`/search?keywords=${e}&type=${n}&offset=${t}`);function Ln(){const e=Ye(),[n,t]=h.exports.useState(""),[o,s]=h.exports.useState(!1),l=h.exports.useRef(null),[i,a]=h.exports.useState({}),c=h.exports.useCallback(ln(async r=>{const{result:u}=await Bn(r),m={};Array.isArray(u.songs)&&(m.songs=u.songs.map(p=>({path:`/Song?id=${p.id}`,text:`${p.name} - ${p.artists.map(C=>C.name).join("/")}`}))),Array.isArray(u.albums)&&(m.albums=u.albums.map(p=>({path:`/Album?id=${p.id}`,text:`${p.name} - ${p.artist.name}`}))),Array.isArray(u.artists)&&(m.singers=u.artists.map(p=>({path:`/Singer?id=${p.id}`,text:p.name}))),Array.isArray(u.playlists)&&(m.playlists=u.playlists.map(p=>({path:`/Playlist?id=${p.id}`,text:p.name}))),a(m)},800),[]);return h.exports.useEffect(()=>{n&&c(n)},[n]),b("div",{className:"search-container",children:[d(Le,{className:"search-input",placeholder:"\u641C\u7D22\u97F3\u4E50",suffix:d(Ke,{}),ref:l,onFocus:()=>s(!0),onBlur:()=>setTimeout(s,100,!1),value:n,onChange:r=>t(r.target.value),onPressEnter:()=>{l.current&&l.current.blur(),e(`/Search?keyword=${n}`),t(""),a({})},style:{width:o?320:160}}),o&&b("div",{className:"search-suggest",children:[i.songs&&b("div",{children:[d("div",{className:"search-suggest-title",children:"\u5355\u66F2"}),d("div",{className:"search-suggest-list",children:i.songs.map(r=>d(Q,{className:"search-suggest-item",to:r.path,children:r.text},r.path))})]}),i.albums&&b("div",{children:[d("div",{className:"search-suggest-title",children:"\u4E13\u8F91"}),d("div",{className:"search-suggest-list",children:i.albums.map(r=>d(Q,{className:"search-suggest-item",to:r.path,children:r.text},r.path))})]}),i.singers&&b("div",{children:[d("div",{className:"search-suggest-title",children:"\u6B4C\u624B"}),d("div",{className:"search-suggest-list",children:i.singers.map(r=>d(Q,{className:"search-suggest-item",to:r.path,children:r.text},r.path))})]}),i.playlists&&b("div",{children:[d("div",{className:"search-suggest-title",children:"\u6B4C\u5355"}),d("div",{className:"search-suggest-list",children:i.playlists.map(r=>d(Q,{className:"search-suggest-item",to:r.path,children:r.text},r.path))})]})]})]})}function Rn(){const[e,n]=h.exports.useState({name:null,avatar:null}),[t,o]=h.exports.useState(!1);h.exports.useEffect(()=>{if(on()){const i=window.localStorage.getItem("username"),a=window.localStorage.getItem("avatar");i&&a&&n({name:i,avatar:a})}},[]);const s=()=>{e.name===null&&o(!t)},l=async()=>{(await Mn()).code===200&&(window.localStorage.clear(),n({name:null,avatar:null}))};return b("div",{className:xn.header,children:[d(Mt,{onClick:s,size:40,icon:d(Pt,{}),src:e.avatar?`${e.avatar}?param=80y80`:null}),d("div",{className:"username",children:e.name||"\u672A\u767B\u5F55"}),e.name&&d("div",{className:"logout",onClick:l,children:"\u9000\u51FA\u767B\u5F55"}),d(Ln,{}),t&&d(kn,{onCancel:s,setUserInfo:n})]})}var On=h.exports.memo(Rn);const jn="_container_r0gt6_1";var zn={container:jn};function Un(){const[e,n]=h.exports.useState("Discovery"),{pathname:t}=ke();return h.exports.useEffect(()=>{n(t.slice(1))},[t]),b("div",{className:zn.container,children:[d("input",{type:"checkbox",id:"toggle",className:"input-toggle"}),b("div",{className:"sidebar",children:[d("div",{className:"category",children:"\u63A8\u8350"}),[{text:"\u53D1\u73B0\u97F3\u4E50",Icon:Ke,key:"Discovery"},{text:"\u79C1\u4EBAFM",Icon:Tt,key:"PersonalFM"}].map(({key:o,text:s,Icon:l})=>b(Q,{className:e===o?"item active":"item",to:`/${o}`,children:[d(l,{})," ",s]},o)),d("div",{className:"category",children:"\u6211\u7684\u97F3\u4E50"}),[{text:"\u6211\u7684\u6B4C\u5355",Icon:kt,key:"MySongList"}].map(({key:o,text:s,Icon:l})=>b(Q,{className:e===o?"item active":"item",to:`/${o}`,children:[d(l,{})," ",s]},o)),d("div",{className:"category",children:"GitHub"}),b("a",{className:"item",href:"https://github.com/lisianthus-a/react-music",target:"_blank",children:[d(Bt,{})," \u9879\u76EE\u5730\u5740"]}),b("a",{className:"item",href:"https://binaryify.github.io/NeteaseCloudMusicApi/#/?id=neteasecloudmusicapi",target:"_blank",children:[d(Lt,{})," API\u6587\u6863"]})]}),d("label",{htmlFor:"toggle",children:d("div",{className:"toggle"})})]})}var Vn=h.exports.memo(Un),Hn={"music-player":"_music-player_1eudp_1"};const qn="_container_ivqz9_1";var Wn={container:qn};function Gn({playingItem:e,currentTime:n}){const{id:t,name:o,cover:s,singers:l,duration:i}=e,a=h.exports.useMemo(()=>l.map(({name:r})=>r).join("/"),[l]),c=`${_e(n)} / ${_e(i)}`;return b("div",{className:Wn.container,children:[d("img",{src:`${s}?param=50y50`}),b("div",{className:"information",children:[b("div",{className:"song",children:[d(Q,{to:`/Song?id=${t}`,children:o}),"\xA0-\xA0",d("span",{className:"singer",title:a,children:a})]}),d("div",{className:"time",children:c})]})]})}const Xn="_container_13n9u_1";var Yn={container:Xn};function Kn(){const{getSong:e,playSong:n,pauseSong:t}=h.exports.useContext(we),o=h.exports.useContext(Ve),{isPlaying:s,playingItem:l}=o,i=c=>{const r=e(c,o);n(r)},a=()=>{s?t():n(l)};return b("div",{className:Yn.container,children:[d("div",{className:"prev",title:"\u4E0A\u4E00\u9996",onClick:()=>i("prev"),children:d(Rt,{})}),d("div",{className:"play-or-pause",onClick:a,title:"\u64AD\u653E/\u6682\u505C",children:s?d(Ot,{}):d(Qe,{})}),d("div",{className:"next",title:"\u4E0B\u4E00\u9996",onClick:()=>i("next"),children:d(jt,{})})]})}var Qn=h.exports.memo(Kn),Zn={"other-button":"_other-button_1huph_1"};const Jn="_playlist_sthgb_1";var es={playlist:Jn};function ts({isPlaying:e,playlist:n,playingItem:t,currentTime:o}){const{playSong:s,collectSong:l,setPlaylist:i}=h.exports.useContext(we),[a,c]=h.exports.useState(t.lyric),r=h.exports.useRef(null),u=h.exports.useRef(null),m=h.exports.useRef(null),p=h.exports.useRef(t.id),C=()=>{Se().delAll(),i([])},f=async v=>{const y=n[v];s(y)},g=(v,y,_)=>{v.stopPropagation(),R().download(y,_)},w=async(v,y)=>{v.stopPropagation();const _=n.slice(),N=_.findIndex(S=>S.id===t.id),A=_.splice(y,1);if(Se().del(A[0].id),i(_),N===y&&e){const S=_[y]||_[_.length-1];S&&s(S)}},x=(v,y)=>{v.stopPropagation(),l(y)};return et(()=>{if(!toggleList.checked)return;const v=u.current.getElementsByClassName("lyric");if(v.length===0)return;const y=()=>{let E=0,P=v.length-1;for(;E<=P;){const k=E+P>>1,L=Number(v[k].dataset.time);o<L?P=k-1:E=k+1}return E-1};let _;const N=Number(v[0].dataset.time),A=Number(v[v.length-1].dataset.time);if(o>=A)_=v[v.length-1];else{if(o<=N)return;{const E=y();_=v[E]}}if(m.current===_)return;m.current&&m.current.classList.remove("active"),m.current=_,_.classList.add("active");const S=m.current.offsetTop+m.current.scrollHeight/2-195;u.current.scrollTop=S<0?0:S},400),h.exports.useEffect(()=>{t.id!==p.current?(m.current&&m.current.classList.remove("active"),u.current.scrollTop=0,p.current=t.id,c(t.lyric)):t.lyric&&c(t.lyric)},[t]),h.exports.useEffect(()=>{if(r.current){const v=r.current.getContext("2d");R().setCanvasContext(v),R().drawStart()}},[r]),b("div",{className:es.playlist,children:[d("div",{className:"icon",title:"\u64AD\u653E\u5217\u8868",children:b("label",{htmlFor:"toggleList",children:[d(zt,{}),n.length]})}),d("input",{type:"checkbox",id:"toggleList",className:"toggle"}),b("div",{className:"list",children:[d("canvas",{ref:r,height:"310",width:"900"}),b("div",{className:"list-left",children:[b("div",{className:"title",children:[b("span",{children:["\u64AD\u653E\u5217\u8868 (",n.length,")"]}),b("span",{className:"clean",onClick:C,children:[d(Ze,{})," \u6E05\u7A7A"]})]}),d("div",{className:"content",children:n.map(({id:v,name:y,singers:_,duration:N},A)=>b("div",{className:v===t.id?"item playing":"item",onClick:()=>f(A),children:[v===t.id&&d(Qe,{}),d("div",{className:"song-title",title:y,children:y}),b("div",{className:"icons",children:[d(Ut,{title:"\u6DFB\u52A0\u5230\u6B4C\u5355",onClick:S=>x(S,v)}),d(Vt,{title:"\u4E0B\u8F7D",onClick:S=>g(S,v,y)}),d(Ze,{title:"\u5220\u9664",onClick:S=>w(S,A)})]}),d("div",{className:"singer",title:_.map(({name:S})=>S).join("/"),children:_.map(({name:S})=>S).join("/")}),d("div",{className:"duration",children:_e(N)})]},v))})]}),b("div",{className:"list-right",children:[d("div",{className:"title",children:d("span",{title:t.name,children:t.name})}),b("div",{className:"content",ref:u,children:[a===null&&d("p",{children:"\u6B4C\u8BCD\u52A0\u8F7D\u4E2D..."}),a&&a.length===0&&d("p",{children:"\u6682\u65E0\u6B4C\u8BCD"}),a&&a.map(([v,y,_],N)=>b("p",{"data-time":_,className:"lyric",children:[v,y&&b(Ht,{children:[d("br",{}),y]})]},N))]})]}),d("label",{htmlFor:"toggleList",children:d("div",{className:"close",children:"X"})})]})]})}var ns={"play-mode":"_play-mode_txlgz_1"};const ss=qt({scriptUrl:"//at.alicdn.com/t/font_2138442_yp24oyx9jzn.js"});function ct(e){return d(ss,B({},e))}const as={"list-loop":d(Wt,{title:"\u5217\u8868\u5FAA\u73AF"}),random:d(ct,{type:"icon-random",title:"\u968F\u673A"}),"single-cycle":d(ct,{type:"icon-Singlecycle",title:"\u5355\u66F2\u5FAA\u73AF"})};function rs({playMode:e}){const{setPlayMode:n}=h.exports.useContext(we),t=()=>{let s;e==="list-loop"?s="random":e==="random"?s="single-cycle":s="list-loop",n(s)},o=as[e];return d("div",{className:ns["play-mode"],children:d("div",{className:"icon",onClick:t,children:o})})}var os=h.exports.memo(rs);const is="_volume_jlvx2_1";var ls={volume:is};function cs(){const e=n=>{R().setVolume(n*.01)};return b("div",{className:ls.volume,children:[d("div",{className:"icon",title:"\u97F3\u91CF",children:d(Gt,{})}),d("div",{className:"slider",children:d(Xt,{defaultValue:100,onChange:e,tipFormatter:n=>`${n}%`})})]})}var us=h.exports.memo(cs);function ds({isPlaying:e,playingItem:n,playlist:t,playMode:o,currentTime:s}){return b("div",{className:Zn["other-button"],children:[d(ts,{isPlaying:e,playingItem:n,playlist:t,currentTime:s}),d(os,{playMode:o}),d(us,{})]})}const ms="_progressbar_gqgv7_1";var hs={progressbar:ms};function ps({playingItem:e,currentTime:n,setCurrentTime:t}){const{duration:o}=e,[s,l]=h.exports.useState(!1),i=h.exports.useRef(null),a=h.exports.useRef(null),{playSong:c}=h.exports.useContext(we),r=C=>{if(C.button!==0)return;window.addEventListener("mousemove",m),window.addEventListener("mouseup",u),l(!0);const f=window.innerWidth<1e3?1e3:window.innerWidth,g=C.clientX/f;i.current.style.width=`${g*100}%`,a.current.textContent=_e(g*o)},u=C=>{window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",u),l(!1);const f=window.innerWidth<1e3?1e3:window.innerWidth;let w=C.clientX/f*o;w<0?w=0:w>o&&(w=o),t(w),c(e,w)},m=C=>{const f=window.innerWidth<1e3?1e3:window.innerWidth;let g=C.clientX/f;g>1?g=1:g<0&&(g=0),i.current.style.width=`${g*100}%`,a.current.textContent=_e(g*o)},p=h.exports.useMemo(()=>s?{width:i.current.style.width}:{width:`${n/o*100}%`},[n,o]);return b("div",{className:hs.progressbar,children:[d("div",{className:"track",onMouseDown:r}),b("div",{className:"rail",onMouseDown:r,ref:i,style:p,children:[d("div",{className:"handle"}),d("div",{className:"tooltip",ref:a,style:{display:s?"block":"none"}})]})]})}var fs=h.exports.memo(ps);function gs(){const e=h.exports.useContext(Ve),[n,t]=h.exports.useState(0),{isPlaying:o,playMode:s,playlist:l,playingItem:i}=e;return et(()=>{const a=R().getCurrentTime();t(a)},300),b("div",{className:Hn["music-player"],children:[d(Gn,{playingItem:i,currentTime:n}),d(Qn,{}),d(ds,{isPlaying:o,playingItem:i,playlist:l,playMode:s,currentTime:n}),d(fs,{playingItem:i,currentTime:n,setCurrentTime:t})]})}var vs=h.exports.memo(gs);function ys({children:e}){return b("div",{className:ae.layout,children:[d("div",{className:ae.top,children:d(On,{})}),b("div",{className:ae.middle,children:[d("div",{className:ae.left,children:d(Vn,{})}),d("div",{className:ae.right,children:e})]}),d("div",{className:ae.bottom,children:d(vs,{})})]})}var _s=h.exports.memo(ys);const ws="_container_nbwis_9";var bs={container:ws,"scale-out-in":"_scale-out-in_nbwis_1"};const Cs=new Array(16).fill(0);function ut({text:e}){return b("div",{className:bs.container,children:[d("div",{className:"loader",children:Cs.map((n,t)=>d("div",{className:"square"},t))}),d("div",{className:"loading-text",children:e||"\u52A0\u8F7D\u4E2D"})]})}const Ss="modulepreload",dt={},xs="/",O=function(n,t){return!t||t.length===0?n():Promise.all(t.map(o=>{if(o=`${xs}${o}`,o in dt)return;dt[o]=!0;const s=o.endsWith(".css"),l=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${l}`))return;const i=document.createElement("link");if(i.rel=s?"stylesheet":Ss,s||(i.as="script",i.crossOrigin=""),i.href=o,document.head.appendChild(i),s)return new Promise((a,c)=>{i.addEventListener("load",a),i.addEventListener("error",c)})})).then(()=>n())};var Ns=[{isDynamic:!1,path:"/Album",component:()=>O(()=>import("./index.a5c65e3c.js"),["assets/index.a5c65e3c.js","assets/index.88dbd4ba.css","assets/vendor.fb93b9f7.js","assets/index.20099192.js","assets/index.7f409210.css","assets/index.ba2972c4.js","assets/index.52dd9ed1.css"])},{isDynamic:!1,path:"/Discovery",component:()=>O(()=>import("./index.c4e10352.js"),["assets/index.c4e10352.js","assets/index.218aba9a.css","assets/vendor.fb93b9f7.js"])},{isDynamic:!1,path:"/MySongList",component:()=>O(()=>import("./index.2fa9e808.js"),["assets/index.2fa9e808.js","assets/index.72357c03.css","assets/vendor.fb93b9f7.js"])},{isDynamic:!1,path:"/PersonalFM",component:()=>O(()=>import("./index.801b1d2a.js"),["assets/index.801b1d2a.js","assets/index.bd36bfc0.css","assets/vendor.fb93b9f7.js"])},{isDynamic:!1,path:"/Playlist",component:()=>O(()=>import("./index.bc5ea0ae.js"),["assets/index.bc5ea0ae.js","assets/index.51c499bb.css","assets/vendor.fb93b9f7.js","assets/index.20099192.js","assets/index.7f409210.css","assets/index.ba2972c4.js","assets/index.52dd9ed1.css"])},{isDynamic:!1,path:"/Search",component:()=>O(()=>import("./index.f2430bbd.js"),["assets/index.f2430bbd.js","assets/index.e18f0d13.css","assets/vendor.fb93b9f7.js","assets/index.cab4daa5.js","assets/index.6869e2d8.css","assets/index.ba2972c4.js","assets/index.52dd9ed1.css"])},{isDynamic:!1,path:"/Singer",component:()=>O(()=>import("./index.ba3e1cff.js"),["assets/index.ba3e1cff.js","assets/index.42fb7331.css","assets/vendor.fb93b9f7.js","assets/index.ba2972c4.js","assets/index.52dd9ed1.css","assets/index.cab4daa5.js","assets/index.6869e2d8.css"])},{isDynamic:!1,path:"/Song",component:()=>O(()=>import("./index.487ab1ce.js"),["assets/index.487ab1ce.js","assets/index.fb0015a2.css","assets/vendor.fb93b9f7.js","assets/index.20099192.js","assets/index.7f409210.css"])},{isDynamic:!1,path:"/User",component:()=>O(()=>import("./index.4b4b0d22.js"),["assets/index.4b4b0d22.js","assets/vendor.fb93b9f7.js"])},{isDynamic:!1,path:"/Video",component:()=>O(()=>import("./index.164425d8.js"),["assets/index.164425d8.js","assets/vendor.fb93b9f7.js"])}];const mt={},Ue={};Ns.forEach(e=>{const{path:n,isDynamic:t}=e;t?Ue[n]=e:mt[n]=e});function As(){const e=Ye(),n=ke(),[t,o]=h.exports.useState(null),[s,l]=h.exports.useState({}),[i,a]=h.exports.useState({});return h.exports.useEffect(()=>{const{search:c,pathname:r}=n,m=(c.match(/[?&]([^?&]+)=([^?&]+)/g)||[]).reduce((C,f)=>{const[g,w]=f.slice(1).split("=");return C[g]=w,C},{});l(m);const p=mt[r]||null;if(p){o(h.exports.lazy(p.component)),a({});return}for(const C in Ue){const{path:f,component:g}=Ue[C],w=(f.match(/\[[^\/]+\]/g)||[]).map(y=>y.slice(1,-1)),x=new RegExp(f.replace(/\[[^\/]+\]/g,"([^/]+)")),v=(r.match(x)||[]).slice(1);if(w.length===v.length){const y={};for(let _=0;_<w.length;++_){const N=w[_],A=v[_];y[N]=A}o(h.exports.lazy(g)),a(y);return}}e("/Discovery")},[n]),t?d(h.exports.Suspense,{fallback:d(ut,{}),children:d(t,{query:s,pageParams:i})}):null}var Es={"collect-song":"_collect-song_4xve9_1"};const js=e=>M(`/playlist/detail?id=${e}`),zs=e=>M(`/comment/playlist?id=${e}`),Fs=(e,n,t)=>M(`/playlist/tracks?op=${e}&pid=${n}&tracks=${t}`),Us=e=>M(`/playlist/delete?id=${e}`),Is=e=>M(`/user/playlist?uid=${e}`);function Ds({id:e}){const[n,t]=h.exports.useState(null),[o,s]=h.exports.useState(null),[l,i]=h.exports.useState(!1),a=window.localStorage.getItem("userid");if(!a)return d("div",{children:"\u672A\u627E\u5230 userid\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55"});const c=()=>{!o||(i(!0),Fs("add",o,e).then(()=>{Be.destroyAll(),Je.success("\u5DF2\u6536\u85CF\u6B4C\u66F2")}))};return h.exports.useEffect(()=>{(async()=>{const u=await Is(a),m=u.playlist.filter(({subscribed:f})=>!f),p=u.playlist.filter(({subscribed:f})=>f),C=[{title:`\u6211\u521B\u5EFA\u7684\u6B4C\u5355 (${m.length})`,value:"0-0",selectable:!1,children:m.map(({name:f,id:g})=>({title:f,value:g}))},{title:`\u6211\u6536\u85CF\u7684\u6B4C\u5355 (${p.length})`,value:"0-1",selectable:!1,children:p.map(({name:f,id:g})=>({title:f,value:g}))}];t(C)})()},[]),n?b("div",{className:Es["collect-song"],children:[d(Yt,{treeData:n,style:{width:"100%"},onChange:r=>s(r),treeDefaultExpandAll:!0,placeholder:"\u8BF7\u9009\u62E9\u6B4C\u5355"}),d(Xe,{onClick:c,type:"primary",loading:l,style:{marginTop:30},children:"\u786E\u8BA4"})]}):d(ut,{})}const ht={id:776039,name:"ONE's hope",singers:[{id:18303,name:"\u3084\u306A\u304E\u306A\u304E"}],duration:369.72,cover:"https://p1.music.126.net/l22TRH7bs4VG6HMT2Iy56w==/2511284557902801.jpg",isFree:!0,albumId:76484,albumName:"Colorful Parade"},pt={isPlaying:!1,playlist:[ht],playMode:"list-loop",playingItem:j(B({},ht),{lyric:null})},Ve=Re.createContext(pt),we=Re.createContext(null),ft=document.getElementById("audio");function $s(){const[e,n]=Jt(pt),t=h.exports.useMemo(()=>({getSong:(r,u)=>{const{playlist:m,playingItem:p,playMode:C}=u,f=m.length;if(f<=1||C==="single-cycle")return p;const g=m.findIndex(({id:x})=>x===p.id);let w;switch(C){case"list-loop":w=r==="next"?(g+1)%f:(f+g-1)%f;break;case"random":w=Math.random()*f>>0,w===g&&(w=(g+1)%f)}return m[w]},playSong:(r,u)=>{const{id:m}=r;n({isPlaying:!0,playingItem:j(B({},r),{lyric:null})}),R().play(m,u).then(p=>{p?(ft.play(),n({playingItem:R().getPlayingItem()})):Je.error(`\u52A0\u8F7D\u6B4C\u66F2\u5931\u8D25\uFF0Cid:${m}`)})},collectSong:r=>{Be.info({title:"\u6536\u85CF\u6B4C\u66F2",maskClosable:!0,okButtonProps:{style:{display:"none"}},width:500,content:d(Ds,{id:r})})},pauseSong:()=>{ft.pause(),R().pause(),n({isPlaying:!1})},setPlaylist:r=>{n({playlist:r})},setPlayMode:r=>{n({playMode:r})}}),[]);return h.exports.useEffect(()=>{if(!navigator.mediaSession||!MediaMetadata||!e.playingItem)return;const{name:o,singers:s,cover:l,albumName:i}=e.playingItem;navigator.mediaSession.metadata=new MediaMetadata({title:o,artist:s.map(a=>a.name).join("/"),album:i,artwork:[{src:`${l}?param=96y96`,sizes:"96x96",type:"image/jpeg"},{src:`${l}?param=128y128`,sizes:"128x128",type:"image/jpeg"},{src:`${l}?param=192y192`,sizes:"192x192",type:"image/jpeg"},{src:`${l}?param=256y256`,sizes:"256x256",type:"image/jpeg"},{src:`${l}?param=384y384`,sizes:"384x384",type:"image/jpeg"},{src:`${l}?param=512y512`,sizes:"512x512",type:"image/jpeg"}]})},[e]),h.exports.useEffect(()=>{!navigator.mediaSession||!MediaMetadata||(navigator.mediaSession.setActionHandler("play",()=>{const{playingItem:o}=e;t.playSong(o)}),navigator.mediaSession.setActionHandler("pause",()=>{t.pauseSong()}),navigator.mediaSession.setActionHandler("previoustrack",()=>{const o=t.getSong("prev",e);t.playSong(o)}),navigator.mediaSession.setActionHandler("nexttrack",()=>{const o=t.getSong("next",e);t.playSong(o)}))},[e]),h.exports.useEffect(()=>{R().setOnEnded(()=>{const{getSong:o,playSong:s}=t,l=o("next",e);s(l)})},[e]),d(we.Provider,{value:t,children:d(Ve.Provider,{value:e,children:d(_s,{children:d(As,{})})})})}function Ms(){return d(Kt,{children:d($s,{})})}Qt.render(d(Re.StrictMode,{children:d(Ms,{})}),document.getElementById("root"));export{we as F,ut as L,Ve as S,M as a,dn as b,Se as c,z as d,Ls as e,_e as f,Fs as g,et as h,ln as i,on as j,Us as k,ae as l,R as m,Is as n,zs as o,js as p,Jt as q,Rs as r,an as s,Os as t,ks as u,rn as v,un as w,Bs as x};
