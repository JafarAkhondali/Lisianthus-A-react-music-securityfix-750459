var Mt=Object.defineProperty,Lt=Object.defineProperties;var Ot=Object.getOwnPropertyDescriptors;var Ze=Object.getOwnPropertySymbols;var Rt=Object.prototype.hasOwnProperty,jt=Object.prototype.propertyIsEnumerable;var Oe=(e,n,t)=>n in e?Mt(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,O=(e,n)=>{for(var t in n||(n={}))Rt.call(n,t)&&Oe(e,t,n[t]);if(Ze)for(var t of Ze(n))jt.call(n,t)&&Oe(e,t,n[t]);return e},q=(e,n)=>Lt(e,Ot(n));var L=(e,n,t)=>(Oe(e,typeof n!="symbol"?n+"":n,t),t);import{r as h,u as Re,a as Je,j as f,b as d,T as zt,B as et,M as Se,m as je,F as xe,L as k,c as Ut,d as Vt,e as Ne,I as ze,f as tt,S as nt,A as Ht,U as qt,g as Wt,P as Gt,C as Ue,h as Xt,i as Kt,D as Ve,k as st,l as at,R as Yt,n as Qt,o as Zt,p as Jt,H as rt,G as en,q as tn,s as be,t as nn,v as sn}from"./vendor.47a03c39.js";const an=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerpolicy&&(l.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?l.credentials="include":s.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}};an();const it=(e,n)=>{const t=h.exports.useRef(()=>{});h.exports.useEffect(()=>{t.current=e},[e]),h.exports.useEffect(()=>{if(n!==null){const i=setInterval(()=>t.current(),n);return()=>clearInterval(i)}},[n])},rn=(e={})=>{const[n,t]=h.exports.useState(e),i=h.exports.useCallback(s=>{t(l=>Object.assign({},l,s instanceof Function?s(l):s))},[]);return[n,i]},on=e=>{const{search:n}=Re(),t=new RegExp(`[?&]${e}=([\\w%]+)`),i=n.match(t);return i?i[1]:null},ln="https://server0309.herokuapp.com",cn={method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!0},P=async(e,n={})=>(await Je(O(O({url:ln+e},cn),n))).data,un=30;class dn{constructor(){L(this,"cacheIds");L(this,"cache");this.cacheIds=[],this.cache=new Map}save(n,t){const{cache:i,cacheIds:s}=this;if(s.length>=un){const l=s.shift();i.delete(l)}i.set(n,t)}get(n){return this.cache.get(n)||null}del(n){const{cache:t,cacheIds:i}=this,s=i.findIndex(l=>l===n);s!==-1&&(i.splice(s,1),t.delete(n))}delAll(){const{cache:n}=this;n.clear(),this.cacheIds=[]}}var Fe=(()=>{let e;return()=>e||(e=new dn)})();const na=e=>P(`/comment/music?id=${e}`),ot=e=>P(`/song/detail?ids=${e.join()}`),mn=async e=>P(`/lyric?id=${e}`),hn=()=>{const e=Number(localStorage.getItem("timestampBefore"));if(Date.now()>=e)return localStorage.removeItem("timestampBefore"),localStorage.removeItem("token"),!1;const n=localStorage.getItem("token");return Boolean(n)},ae=e=>{const n=e/60>>0,t=e%60>>0;return`${n.toString().padStart(2,"0")}:${t.toString().padStart(2,"0")}`},pn=e=>{const n=Date.now()-e,t=new Date(n);return n<=6e4?"\u521A\u521A":n<=36e5?`${n/6e4>>0} \u5206\u949F\u524D`:n<=864e5?`${n/36e5>>0} \u5C0F\u65F6\u524D`:t.getFullYear()>1970?`${t.getFullYear()-1970} \u5E74\u524D`:t.getMonth()?`${t.getMonth()} \u6708\u524D`:`${t.getDate()-1} \u5929\u524D`},fn=(e,n)=>{let t;return function(...i){clearTimeout(t),t=setTimeout(()=>{e.call(this,...i)},n)}},H=e=>e.replace(/http\:/,"https:"),gn=e=>{const[n,t,i]=e.match(/\d+/g);return Number(n)*60+Number(t)+Number(i)*.001},vn=e=>{var r,u;const{uncollected:n,nolyric:t,lrc:i,tlyric:s}=e;if(n||t)return[];const l=i.lyric.split(`
`).filter(m=>/\d+\:\d+[\.\:]\d+/.test(m)),o=((u=(r=s==null?void 0:s.lyric)==null?void 0:r.split(`
`))==null?void 0:u.filter(m=>/\d+\:\d+[\.\:]\d+/.test(m)))||[],a=(m,g)=>{const S=m.lastIndexOf("]"),y=m.slice(S+1);m.match(/\d+\:\d+[\.\:]\d+/g).forEach(b=>{const F=gn(b);g?c[F]=[y,"",F]:c[F]&&(c[F][1]=y)})},c={};return l.forEach(m=>a(m,!0)),o.forEach(m=>a(m,!1)),Object.values(c).sort((m,g)=>m[2]-g[2])},lt=(e,n)=>e.map(t=>{const{id:i,name:s}=t,l=["topSong","fm","search"].includes(n)?t.album:t.al,o=n==="detail"?t.ar:t.artists,a=["simiSong","fm","search"].includes(n)?t.duration:t.dt,c=t.fee!==1;return{id:i,name:s,isFree:c,duration:a*.001,singers:o.map(({id:r,name:u})=>({id:r,name:u})),albumId:l.id,albumName:l.name,cover:H(l.picUrl||"")}}),sa=e=>{const n=e.hasOwnProperty("playlist"),t=e.hasOwnProperty("album"),i=!n&&!t;if(n){const{name:s,tags:l,description:o,createTime:a}=e.playlist,c=H(e.playlist.coverImgUrl),r={id:e.playlist.creator.userId,name:e.playlist.creator.nickname,avatar:H(e.playlist.creator.avatarUrl),createTime:a},u=Number(localStorage.getItem("userid"))===r.id;return{isPlaylist:n,isAlbum:t,isSong:i,title:s,cover:c,creator:r,isCreator:u,tags:l,description:o}}else if(t){const{name:s,publishTime:l,description:o}=e.album,a=e.album.artists.map(({id:r,name:u})=>({id:r,name:u})),c=H(e.album.picUrl);return{isPlaylist:n,isAlbum:t,isSong:i,title:s,cover:c,singers:a,publishTime:l,description:o}}else{const{name:s,al:{id:l,name:o}}=e.songs[0],a=e.songs[0].ar.map(({id:r,name:u})=>({id:r,name:u})),c=H(e.songs[0].al.picUrl);return{isPlaylist:n,isAlbum:t,isSong:i,title:s,cover:c,singers:a,albumId:l,albumName:o}}};var yn=function(e){function n(i){if(t[i])return t[i].exports;var s=t[i]={i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}var t={};return n.m=e,n.c=t,n.i=function(i){return i},n.d=function(i,s,l){n.o(i,s)||Object.defineProperty(i,s,{configurable:!1,enumerable:!0,get:l})},n.n=function(i){var s=i&&i.__esModule?function(){return i.default}:function(){return i};return n.d(s,"a",s),s},n.o=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)},n.p="",n(n.s=0)}([function(e,n,t){function i(s){if(this.size=0|s,this.size<=1||(this.size&this.size-1)!=0)throw new Error("FFT size must be a power of two and bigger than 1");this._csize=s<<1;for(var l=new Array(2*this.size),o=0;o<l.length;o+=2){var a=Math.PI*o/this.size;l[o]=Math.cos(a),l[o+1]=-Math.sin(a)}this.table=l;for(var c=0,r=1;this.size>r;r<<=1)c++;this._width=c%2==0?c-1:c,this._bitrev=new Array(1<<this._width);for(var u=0;u<this._bitrev.length;u++){this._bitrev[u]=0;for(var m=0;m<this._width;m+=2){var g=this._width-m-2;this._bitrev[u]|=(u>>>m&3)<<g}}this._out=null,this._data=null,this._inv=0}e.exports=i,i.prototype.fromComplexArray=function(s,l){for(var o=l||new Array(s.length>>>1),a=0;a<s.length;a+=2)o[a>>>1]=s[a];return o},i.prototype.createComplexArray=function(){for(var s=new Array(this._csize),l=0;l<s.length;l++)s[l]=0;return s},i.prototype.toComplexArray=function(s,l){for(var o=l||this.createComplexArray(),a=0;a<o.length;a+=2)o[a]=s[a>>>1],o[a+1]=0;return o},i.prototype.completeSpectrum=function(s){for(var l=this._csize,o=l>>>1,a=2;a<o;a+=2)s[l-a]=s[a],s[l-a+1]=-s[a+1]},i.prototype.transform=function(s,l){if(s===l)throw new Error("Input and output buffers must be different");this._out=s,this._data=l,this._inv=0,this._transform4(),this._out=null,this._data=null},i.prototype.realTransform=function(s,l){if(s===l)throw new Error("Input and output buffers must be different");this._out=s,this._data=l,this._inv=0,this._realTransform4(),this._out=null,this._data=null},i.prototype.inverseTransform=function(s,l){if(s===l)throw new Error("Input and output buffers must be different");this._out=s,this._data=l,this._inv=1,this._transform4();for(var o=0;o<s.length;o++)s[o]/=this.size;this._out=null,this._data=null},i.prototype._transform4=function(){var s,l,o=this._out,a=this._csize,c=this._width,r=1<<c,u=a/r<<1,m=this._bitrev;if(u===4)for(s=0,l=0;s<a;s+=u,l++){var g=m[l];this._singleTransform2(s,g,r)}else for(s=0,l=0;s<a;s+=u,l++){var S=m[l];this._singleTransform4(s,S,r)}var y=this._inv?-1:1,_=this.table;for(r>>=2;r>=2;r>>=2){u=a/r<<1;var b=u>>>2;for(s=0;s<a;s+=u)for(var F=s+b,C=s,p=0;C<F;C+=2,p+=r){var v=C,w=v+b,N=w+b,x=N+b,A=o[v],B=o[v+1],T=o[w],M=o[w+1],V=o[N],j=o[N+1],z=o[x],X=o[x+1],K=A,Y=B,Q=_[p],Z=y*_[p+1],oe=T*Q-M*Z,le=T*Z+M*Q,ce=_[2*p],ue=y*_[2*p+1],de=V*ce-j*ue,me=V*ue+j*ce,he=_[3*p],pe=y*_[3*p+1],fe=z*he-X*pe,ge=z*pe+X*he,ve=K+de,ee=Y+me,te=K-de,ye=Y-me,_e=oe+fe,ne=le+ge,se=y*(oe-fe),Ce=y*(le-ge),we=ve+_e,Ie=ee+ne,Be=ve-_e,ke=ee-ne,Pe=te+Ce,Te=ye-se,Me=te-Ce,Le=ye+se;o[v]=we,o[v+1]=Ie,o[w]=Pe,o[w+1]=Te,o[N]=Be,o[N+1]=ke,o[x]=Me,o[x+1]=Le}}},i.prototype._singleTransform2=function(s,l,o){var a=this._out,c=this._data,r=c[l],u=c[l+1],m=c[l+o],g=c[l+o+1],S=r+m,y=u+g,_=r-m,b=u-g;a[s]=S,a[s+1]=y,a[s+2]=_,a[s+3]=b},i.prototype._singleTransform4=function(s,l,o){var a=this._out,c=this._data,r=this._inv?-1:1,u=2*o,m=3*o,g=c[l],S=c[l+1],y=c[l+o],_=c[l+o+1],b=c[l+u],F=c[l+u+1],C=c[l+m],p=c[l+m+1],v=g+b,w=S+F,N=g-b,x=S-F,A=y+C,B=_+p,T=r*(y-C),M=r*(_-p),V=v+A,j=w+B,z=N+M,X=x-T,K=v-A,Y=w-B,Q=N-M,Z=x+T;a[s]=V,a[s+1]=j,a[s+2]=z,a[s+3]=X,a[s+4]=K,a[s+5]=Y,a[s+6]=Q,a[s+7]=Z},i.prototype._realTransform4=function(){var s,l,o=this._out,a=this._csize,c=this._width,r=1<<c,u=a/r<<1,m=this._bitrev;if(u===4)for(s=0,l=0;s<a;s+=u,l++){var g=m[l];this._singleRealTransform2(s,g>>>1,r>>>1)}else for(s=0,l=0;s<a;s+=u,l++){var S=m[l];this._singleRealTransform4(s,S>>>1,r>>>1)}var y=this._inv?-1:1,_=this.table;for(r>>=2;r>=2;r>>=2){u=a/r<<1;var b=u>>>1,F=b>>>1,C=F>>>1;for(s=0;s<a;s+=u)for(var p=0,v=0;p<=C;p+=2,v+=r){var w=s+p,N=w+F,x=N+F,A=x+F,B=o[w],T=o[w+1],M=o[N],V=o[N+1],j=o[x],z=o[x+1],X=o[A],K=o[A+1],Y=B,Q=T,Z=_[v],oe=y*_[v+1],le=M*Z-V*oe,ce=M*oe+V*Z,ue=_[2*v],de=y*_[2*v+1],me=j*ue-z*de,he=j*de+z*ue,pe=_[3*v],fe=y*_[3*v+1],ge=X*pe-K*fe,ve=X*fe+K*pe,ee=Y+me,te=Q+he,ye=Y-me,_e=Q-he,ne=le+ge,se=ce+ve,Ce=y*(le-ge),we=y*(ce-ve),Ie=ee+ne,Be=te+se,ke=ye+we,Pe=_e-Ce;if(o[w]=Ie,o[w+1]=Be,o[N]=ke,o[N+1]=Pe,p!==0){if(p!==C){var Te=ye,Me=-_e,Le=ee,Nt=-te,Ft=-y*we,At=-y*Ce,Et=-y*se,$t=-y*ne,Dt=Te+Ft,It=Me+At,Bt=Le+$t,kt=Nt-Et,Ye=s+F-p,Qe=s+b-p;o[Ye]=Dt,o[Ye+1]=It,o[Qe]=Bt,o[Qe+1]=kt}}else{var Pt=ee-ne,Tt=te-se;o[x]=Pt,o[x+1]=Tt}}}},i.prototype._singleRealTransform2=function(s,l,o){var a=this._out,c=this._data,r=c[l],u=c[l+o],m=r+u,g=r-u;a[s]=m,a[s+1]=0,a[s+2]=g,a[s+3]=0},i.prototype._singleRealTransform4=function(s,l,o){var a=this._out,c=this._data,r=this._inv?-1:1,u=2*o,m=3*o,g=c[l],S=c[l+o],y=c[l+u],_=c[l+m],b=g+y,F=g-y,C=S+_,p=r*(S-_),v=b+C,w=F,N=-p,x=b-C,A=F,B=p;a[s]=v,a[s+1]=0,a[s+2]=w,a[s+3]=N,a[s+4]=x,a[s+5]=0,a[s+6]=A,a[s+7]=B}}]);const re=512,ct=.08,ut=.8,dt=re/2+1,J=new Array(dt).fill(0),_n=e=>.54-.46*Math.cos(6.283185307179586*e/(re-1)),Cn=e=>{const n=new yn(re),t=n.createComplexArray();n.realTransform(t,e);for(let i=0;i<dt;++i){const s=t[2*i],l=t[2*i+1],o=(s**2+l**2)**.5,a=Math.log10(o)*20;if(!isFinite(a)){J[i]=0;continue}a<J[i]?J[i]=a*ct+J[i]*(1-ct):J[i]=a*ut+J[i]*(1-ut)}};function bn(e){const n=e.getChannelData(0),i=R().getCurrentTime()/e.duration*n.length>>0,s=n.slice(i,i+re),l=re-s.length;for(let o=0;o<l;++o)s[s.length]=0;for(let o=0;o<re;++o){const a=_n(o);s[o]*=a}return Cn(s),J.map(o=>o?(o+20)*.0125:0)}const He=900,Ae=310;class wn{constructor(){L(this,"onEnded");L(this,"startTime");L(this,"playingItem");L(this,"rejectFn");L(this,"audioContext");L(this,"gainNode");L(this,"reqId");L(this,"canvasContext");L(this,"currentSource");this.audioContext=new AudioContext,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination),this.canvasContext=null,this.currentSource=null,this.onEnded=null,this.startTime=!1,this.playingItem=null,this.rejectFn=()=>{},this.reqId=0,this.drawCanvas=this.drawCanvas.bind(this),console.info("musicInstance",this)}drawCanvas(){this.reqId=requestAnimationFrame(this.drawCanvas);const{canvasContext:n,playingItem:t}=this;if(!t)return;const i=bn(t.abuffer);n.clearRect(0,0,He,Ae);const s=He/i.length;for(let l=0;l<i.length;++l){const o=i[l]*Ae,a=l*s,c=Ae-o;n.fillRect(a,c,s,o)}}getMusic(n){return new Promise((t,i)=>{var o,a;const{audioContext:s}=this;if(this.rejectFn=i,n===((a=(o=this.playingItem)==null?void 0:o.info)==null?void 0:a.id)){t(this.playingItem);return}const l=Fe().get(n);if(l){s.decodeAudioData(l.buffer.slice(0)).then(c=>{t(q(O({},l),{abuffer:c}))});return}P(`/getMusicUrl?id=${n}`).then(c=>{var m;if(c.error||((m=c.url)==null?void 0:m.includes("music.163.com/404"))){t(null);return}const{url:r}=c,u=Je({url:H(r),responseType:"arraybuffer"}).then(g=>g.data).catch(g=>null);Promise.all([u,ot([n]),mn(n)]).then(([g,S,y])=>{if(g===null){console.log("get music fail, id:",n),t(null);return}const _=lt(S.songs,"detail")[0],b=vn(y),F={buffer:g,info:q(O({},_),{lyric:b})};Fe().save(n,F),s.decodeAudioData(g.slice(0)).then(C=>{F.info.duration=C.duration,t(q(O({},F),{abuffer:C}))})})})})}async restart(){return await this.audioContext.resume(),!0}async play(n,t){const{currentSource:i,audioContext:s,gainNode:l,playingItem:o,rejectFn:a}=this;if(a(),s.state==="suspended"&&(this.restart(),o&&o.info.id===n&&t===void 0))return!0;this.startTime=!1,i&&(i.onended=null,i.stop(0),i.disconnect());const c=await this.getMusic(n).catch(u=>null);if(!c)return!1;const r=s.createBufferSource();return r.buffer=c.abuffer,r.connect(l),this.currentSource=r,this.startTime=s.currentTime-(t||0),r.start(s.currentTime,t||0),this.playingItem=c,r.onended=()=>{this.startTime=!1,this.onEnded&&this.onEnded()},!0}async pause(){return await this.audioContext.suspend(),!0}setVolume(n){this.gainNode.gain.value=n}drawStart(){cancelAnimationFrame(this.reqId),this.reqId=requestAnimationFrame(this.drawCanvas)}drawStop(){this.canvasContext.clearRect(0,0,He,Ae),cancelAnimationFrame(this.reqId)}setCanvasContext(n){n.fillStyle="#6dccff",this.canvasContext=n}async download(n,t){const i=await this.getMusic(n);if(!i)return!1;const s=new Blob([i.buffer]),l=URL.createObjectURL(s),o=document.createElement("a");return o.href=l,o.download=`${t}.mp3`,o.click(),URL.revokeObjectURL(l),!0}setOnEnded(n){this.onEnded=n}getCurrentTime(){const{audioContext:n,startTime:t}=this;return t!==!1?n.currentTime-t:0}getPlayingItem(){return this.playingItem.info}}var R=(()=>{let e;return()=>e||(e=new wn)})();const Sn="_container_nbwis_9";var xn={container:Sn,"scale-out-in":"_scale-out-in_nbwis_1"};const Nn=new Array(16).fill(0);function qe({text:e}){return f("div",{className:xn.container,children:[d("div",{className:"loader",children:Nn.map((n,t)=>d("div",{className:"square"},t))}),d("div",{className:"loading-text",children:e||"\u52A0\u8F7D\u4E2D"})]})}const Fn="_layout_1k0ru_1",An="_top_1k0ru_5",En="_middle_1k0ru_8",$n="_left_1k0ru_13",Dn="_right_1k0ru_16",In="_bottom_1k0ru_35";var W={layout:Fn,top:An,middle:En,left:$n,right:Dn,bottom:In};function Bn({children:e}){return f("div",{className:W.layout,children:[d("div",{className:W.top,children:d(ss,{})}),f("div",{className:W.middle,children:[d("div",{className:W.left,children:d(js,{})}),d("div",{className:W.right,children:e})]}),d("div",{className:W.bottom,children:d(ks,{})})]})}var kn=h.exports.memo(Bn),Pn={"collect-song":"_collect-song_4xve9_1"};const aa=e=>P(`/playlist/detail?id=${e}`),ra=e=>P(`/comment/playlist?id=${e}`),mt=(e,n,t)=>P(`/playlist/tracks?op=${e}&pid=${n}&tracks=${t}`),ia=e=>P(`/playlist/delete?id=${e}`),Tn=e=>P(`/user/playlist?uid=${e}`);function Mn({id:e}){const[n,t]=h.exports.useState(null),[i,s]=h.exports.useState(null),[l,o]=h.exports.useState(!1),a=window.localStorage.getItem("userid");if(!a)return d("div",{children:"\u672A\u627E\u5230 userid\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55"});const c=()=>{!i||(o(!0),mt("add",i,e).then(()=>{Se.destroyAll(),je.success("\u5DF2\u6536\u85CF\u6B4C\u66F2")}))};return h.exports.useEffect(()=>{(async()=>{const u=await Tn(a),m=u.playlist.filter(({subscribed:y})=>!y),g=u.playlist.filter(({subscribed:y})=>y),S=[{title:`\u6211\u521B\u5EFA\u7684\u6B4C\u5355 (${m.length})`,value:"0-0",selectable:!1,children:m.map(({name:y,id:_})=>({title:y,value:_}))},{title:`\u6211\u6536\u85CF\u7684\u6B4C\u5355 (${g.length})`,value:"0-1",selectable:!1,children:g.map(({name:y,id:_})=>({title:y,value:_}))}];t(S)})()},[]),n?f("div",{className:Pn["collect-song"],children:[d(zt,{treeData:n,style:{width:"100%"},onChange:r=>s(r),treeDefaultExpandAll:!0,placeholder:"\u8BF7\u9009\u62E9\u6B4C\u5355"}),d(et,{onClick:c,type:"primary",loading:l,style:{marginTop:30},children:"\u786E\u8BA4"})]}):d(qe,{})}var Ln={"comment-list":"_comment-list_1pjhk_1"};function On({data:e}){const{hotComments:n,comments:t,total:i}=e,s=(l,o)=>f(xe,{children:[d("div",{className:"sub-title",children:l}),o.map(({beReplied:a,content:c,user:r,time:u,likedCount:m},g)=>f("div",{className:"comment",children:[d("div",{className:"image",children:d("img",{src:`${H(r.avatarUrl)}?param=50y50`,loading:"lazy"})}),f("div",{className:"container",children:[f("div",{className:"content",children:[f("span",{children:[f(k,{to:`User?id=${r.userId}`,children:[r.nickname,"\uFF1A"]}),c]}),a[0]&&d("div",{className:"reply",children:f("span",{children:[f(k,{to:`User?id=${a[0].user.userId}`,children:[a[0].user.nickname,"\uFF1A"]}),a[0].content]})})]}),f("div",{className:"footer",children:[d("span",{className:"date",children:pn(u)}),f("span",{className:"like",children:[d(Ut,{style:{color:"#1890ff"}}),"(",m,")"]})]})]})]},g))]});return f("div",{className:Ln["comment-list"],children:[f("div",{className:"title",children:["\u8BC4\u8BBA\u5217\u8868",f("span",{className:"total",children:["\u5171 ",i," \u6761"]})]}),n.length>0&&s("\u7CBE\u5F69\u8BC4\u8BBA",n),t.length>0&&s("\u6700\u65B0\u8BC4\u8BBA",t)]})}var oa=h.exports.memo(On);const Rn=Vt({scriptUrl:"//at.alicdn.com/t/font_2138442_yp24oyx9jzn.js"});function ht(e){return d(Rn,O({},e))}const jn="_detail_1jp2c_2";var la={detail:jn};const zn="_header_o9m17_1";var Un={header:zn};function G(e,n){var t=(e&65535)+(n&65535),i=(e>>16)+(n>>16)+(t>>16);return i<<16|t&65535}function Vn(e,n){return e<<n|e>>>32-n}function Ee(e,n,t,i,s,l){return G(Vn(G(G(n,e),G(i,l)),s),t)}function E(e,n,t,i,s,l,o){return Ee(n&t|~n&i,e,n,s,l,o)}function $(e,n,t,i,s,l,o){return Ee(n&i|t&~i,e,n,s,l,o)}function D(e,n,t,i,s,l,o){return Ee(n^t^i,e,n,s,l,o)}function I(e,n,t,i,s,l,o){return Ee(t^(n|~i),e,n,s,l,o)}function $e(e,n){e[n>>5]|=128<<n%32,e[(n+64>>>9<<4)+14]=n;var t,i,s,l,o,a=1732584193,c=-271733879,r=-1732584194,u=271733878;for(t=0;t<e.length;t+=16)i=a,s=c,l=r,o=u,a=E(a,c,r,u,e[t],7,-680876936),u=E(u,a,c,r,e[t+1],12,-389564586),r=E(r,u,a,c,e[t+2],17,606105819),c=E(c,r,u,a,e[t+3],22,-1044525330),a=E(a,c,r,u,e[t+4],7,-176418897),u=E(u,a,c,r,e[t+5],12,1200080426),r=E(r,u,a,c,e[t+6],17,-1473231341),c=E(c,r,u,a,e[t+7],22,-45705983),a=E(a,c,r,u,e[t+8],7,1770035416),u=E(u,a,c,r,e[t+9],12,-1958414417),r=E(r,u,a,c,e[t+10],17,-42063),c=E(c,r,u,a,e[t+11],22,-1990404162),a=E(a,c,r,u,e[t+12],7,1804603682),u=E(u,a,c,r,e[t+13],12,-40341101),r=E(r,u,a,c,e[t+14],17,-1502002290),c=E(c,r,u,a,e[t+15],22,1236535329),a=$(a,c,r,u,e[t+1],5,-165796510),u=$(u,a,c,r,e[t+6],9,-1069501632),r=$(r,u,a,c,e[t+11],14,643717713),c=$(c,r,u,a,e[t],20,-373897302),a=$(a,c,r,u,e[t+5],5,-701558691),u=$(u,a,c,r,e[t+10],9,38016083),r=$(r,u,a,c,e[t+15],14,-660478335),c=$(c,r,u,a,e[t+4],20,-405537848),a=$(a,c,r,u,e[t+9],5,568446438),u=$(u,a,c,r,e[t+14],9,-1019803690),r=$(r,u,a,c,e[t+3],14,-187363961),c=$(c,r,u,a,e[t+8],20,1163531501),a=$(a,c,r,u,e[t+13],5,-1444681467),u=$(u,a,c,r,e[t+2],9,-51403784),r=$(r,u,a,c,e[t+7],14,1735328473),c=$(c,r,u,a,e[t+12],20,-1926607734),a=D(a,c,r,u,e[t+5],4,-378558),u=D(u,a,c,r,e[t+8],11,-2022574463),r=D(r,u,a,c,e[t+11],16,1839030562),c=D(c,r,u,a,e[t+14],23,-35309556),a=D(a,c,r,u,e[t+1],4,-1530992060),u=D(u,a,c,r,e[t+4],11,1272893353),r=D(r,u,a,c,e[t+7],16,-155497632),c=D(c,r,u,a,e[t+10],23,-1094730640),a=D(a,c,r,u,e[t+13],4,681279174),u=D(u,a,c,r,e[t],11,-358537222),r=D(r,u,a,c,e[t+3],16,-722521979),c=D(c,r,u,a,e[t+6],23,76029189),a=D(a,c,r,u,e[t+9],4,-640364487),u=D(u,a,c,r,e[t+12],11,-421815835),r=D(r,u,a,c,e[t+15],16,530742520),c=D(c,r,u,a,e[t+2],23,-995338651),a=I(a,c,r,u,e[t],6,-198630844),u=I(u,a,c,r,e[t+7],10,1126891415),r=I(r,u,a,c,e[t+14],15,-1416354905),c=I(c,r,u,a,e[t+5],21,-57434055),a=I(a,c,r,u,e[t+12],6,1700485571),u=I(u,a,c,r,e[t+3],10,-1894986606),r=I(r,u,a,c,e[t+10],15,-1051523),c=I(c,r,u,a,e[t+1],21,-2054922799),a=I(a,c,r,u,e[t+8],6,1873313359),u=I(u,a,c,r,e[t+15],10,-30611744),r=I(r,u,a,c,e[t+6],15,-1560198380),c=I(c,r,u,a,e[t+13],21,1309151649),a=I(a,c,r,u,e[t+4],6,-145523070),u=I(u,a,c,r,e[t+11],10,-1120210379),r=I(r,u,a,c,e[t+2],15,718787259),c=I(c,r,u,a,e[t+9],21,-343485551),a=G(a,i),c=G(c,s),r=G(r,l),u=G(u,o);return[a,c,r,u]}function pt(e){var n,t="",i=e.length*32;for(n=0;n<i;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}function We(e){var n,t=[];for(t[(e.length>>2)-1]=void 0,n=0;n<t.length;n+=1)t[n]=0;var i=e.length*8;for(n=0;n<i;n+=8)t[n>>5]|=(e.charCodeAt(n/8)&255)<<n%32;return t}function Hn(e){return pt($e(We(e),e.length*8))}function qn(e,n){var t,i=We(e),s=[],l=[],o;for(s[15]=l[15]=void 0,i.length>16&&(i=$e(i,e.length*8)),t=0;t<16;t+=1)s[t]=i[t]^909522486,l[t]=i[t]^1549556828;return o=$e(s.concat(We(n)),512+n.length*8),pt($e(l.concat(o),512+128))}function ft(e){var n="0123456789abcdef",t="",i,s;for(s=0;s<e.length;s+=1)i=e.charCodeAt(s),t+=n.charAt(i>>>4&15)+n.charAt(i&15);return t}function Ge(e){return unescape(encodeURIComponent(e))}function gt(e){return Hn(Ge(e))}function Wn(e){return ft(gt(e))}function vt(e,n){return qn(Ge(e),Ge(n))}function Gn(e,n){return ft(vt(e,n))}function yt(e,n,t){return n?t?vt(n,e):Gn(n,e):t?gt(e):Wn(e)}const Xn=(e,n)=>P(`/login?email=${e}&md5_password=${yt(n)}`,{method:"POST"}),Kn=(e,n)=>P(`/login/cellphone?phone=${e}&md5_password=${yt(n)}`,{method:"POST"}),Yn=()=>P("/logout"),Qn={labelCol:{span:4},wrapperCol:{span:20}},Zn={wrapperCol:{offset:18,span:4}};function Jn({onCancel:e,setUserInfo:n}){const[t,i]=h.exports.useState(!1),s=async l=>{const{username:o,password:a}=l;if(!o||!a)return;let c;if(/^[\w-.]+@[\w-.]+\.\w+$/.test(o))c="email";else if(/^1[3-9]\d{9}$/.test(o))c="phone";else return;if(t)return;i(!0);const r=c==="email"?await Xn(o,a):await Kn(o,a);window.localStorage.setItem("username",r.profile.nickname),window.localStorage.setItem("avatar",H(r.profile.avatarUrl)),window.localStorage.setItem("userid",r.account.id),window.localStorage.setItem("token",r.token);const u=Number(r.cookie.match(/MUSIC_U=\w+;\s?Max-Age=(\d+)/)[1]);window.localStorage.setItem("timestampBefore",String(Date.now()+u*1e3)),n({name:r.profile.nickname,avatar:H(r.profile.avatarUrl)}),e()};return d(Se,{title:"\u767B\u5F55",visible:!0,onCancel:e,footer:null,children:f(Ne,q(O({},Qn),{onFinish:s,children:[d(Ne.Item,{label:"\u8D26\u53F7",name:"username",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u8D26\u53F7"}],children:d(ze,{placeholder:"\u8F93\u5165\u624B\u673A\u53F7\u6216\u90AE\u7BB1"})}),d(Ne.Item,{label:"\u5BC6\u7801",name:"password",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"}],children:d(ze,{type:"password",placeholder:"\u8F93\u5165\u5BC6\u7801",autoComplete:"on"})}),d(Ne.Item,q(O({},Zn),{children:d(et,{type:"primary",htmlType:"submit",loading:t,children:"\u767B\u5F55"})}))]}))})}const es=e=>P(`/search/suggest?keywords=${e}`),ca=(e,n,t)=>P(`/search?keywords=${e}&type=${n}&offset=${t}`);function ts(){const e=tt(),[n,t]=h.exports.useState(""),[i,s]=h.exports.useState(!1),l=h.exports.useRef(null),[o,a]=h.exports.useState({}),c=h.exports.useCallback(fn(async r=>{const{result:u}=await es(r),m={};Array.isArray(u.songs)&&(m.songs=u.songs.map(g=>({path:`/Song?id=${g.id}`,text:`${g.name} - ${g.artists.map(S=>S.name).join("/")}`}))),Array.isArray(u.albums)&&(m.albums=u.albums.map(g=>({path:`/Album?id=${g.id}`,text:`${g.name} - ${g.artist.name}`}))),Array.isArray(u.artists)&&(m.singers=u.artists.map(g=>({path:`/Singer?id=${g.id}`,text:g.name}))),Array.isArray(u.playlists)&&(m.playlists=u.playlists.map(g=>({path:`/Playlist?id=${g.id}`,text:g.name}))),a(m)},800),[]);return h.exports.useEffect(()=>{n&&c(n)},[n]),f("div",{className:"search-container",children:[d(ze,{className:"search-input",placeholder:"\u641C\u7D22\u97F3\u4E50",suffix:d(nt,{}),ref:l,onFocus:()=>s(!0),onBlur:()=>setTimeout(s,100,!1),value:n,onChange:r=>t(r.target.value),onPressEnter:()=>{l.current&&l.current.blur(),e(`/Search?keyword=${n}`),t(""),a({})},style:{width:i?320:160}}),i&&f("div",{className:"search-suggest",children:[o.songs&&f("div",{children:[d("div",{className:"search-suggest-title",children:"\u5355\u66F2"}),d("div",{className:"search-suggest-list",children:o.songs.map(r=>d(k,{className:"search-suggest-item",to:r.path,children:r.text},r.path))})]}),o.albums&&f("div",{children:[d("div",{className:"search-suggest-title",children:"\u4E13\u8F91"}),d("div",{className:"search-suggest-list",children:o.albums.map(r=>d(k,{className:"search-suggest-item",to:r.path,children:r.text},r.path))})]}),o.singers&&f("div",{children:[d("div",{className:"search-suggest-title",children:"\u6B4C\u624B"}),d("div",{className:"search-suggest-list",children:o.singers.map(r=>d(k,{className:"search-suggest-item",to:r.path,children:r.text},r.path))})]}),o.playlists&&f("div",{children:[d("div",{className:"search-suggest-title",children:"\u6B4C\u5355"}),d("div",{className:"search-suggest-list",children:o.playlists.map(r=>d(k,{className:"search-suggest-item",to:r.path,children:r.text},r.path))})]})]})]})}function ns(){const[e,n]=h.exports.useState({name:null,avatar:null}),[t,i]=h.exports.useState(!1);h.exports.useEffect(()=>{if(hn()){const o=window.localStorage.getItem("username"),a=window.localStorage.getItem("avatar");o&&a&&n({name:o,avatar:a})}},[]);const s=()=>{e.name===null&&i(!t)},l=async()=>{(await Yn()).code===200&&(window.localStorage.clear(),n({name:null,avatar:null}))};return f("div",{className:Un.header,children:[d(Ht,{onClick:s,size:40,icon:d(qt,{}),src:e.avatar?`${e.avatar}?param=80y80`:null}),d("div",{className:"username",children:e.name||"\u672A\u767B\u5F55"}),e.name&&d("div",{className:"logout",onClick:l,children:"\u9000\u51FA\u767B\u5F55"}),d(ts,{}),t&&d(Jn,{onCancel:s,setUserInfo:n})]})}var ss=h.exports.memo(ns),as={"link-image-list":"_link-image-list_cdedt_1"};function rs({children:e}){return d("div",{className:as["link-image-list"],children:e})}function is({src:e,linkTo:n,text:t}){return f("div",{className:"item",children:[d(k,{to:n,className:"item-image",children:d("img",{src:`${e}?param=240y240`,loading:"lazy"})}),d(k,{to:n,className:"item-info",children:t})]})}rs.Item=is;var os={"music-player":"_music-player_1eudp_1"};const ls="_container_ivqz9_1";var cs={container:ls};function us({playingItem:e,currentTime:n}){const{id:t,name:i,cover:s,singers:l,duration:o}=e,a=h.exports.useMemo(()=>l.map(({name:r})=>r).join("/"),[l]),c=`${ae(n)} / ${ae(o)}`;return f("div",{className:cs.container,children:[d("img",{src:`${s}?param=50y50`}),f("div",{className:"information",children:[f("div",{className:"song",children:[d(k,{to:`/Song?id=${t}`,children:i}),"\xA0-\xA0",d("span",{className:"singer",title:a,children:a})]}),d("div",{className:"time",children:c})]})]})}const ds="_container_13n9u_1";var ms={container:ds};function hs(){const{getSong:e,playSong:n,pauseSong:t}=h.exports.useContext(ie),i=h.exports.useContext(De),{isPlaying:s,playingItem:l}=i,o=c=>{const r=e(c,i);n(r)},a=()=>{s?t():n(l)};return f("div",{className:ms.container,children:[d("div",{className:"prev",title:"\u4E0A\u4E00\u9996",onClick:()=>o("prev"),children:d(Wt,{})}),d("div",{className:"play-or-pause",onClick:a,title:"\u64AD\u653E/\u6682\u505C",children:s?d(Gt,{}):d(Ue,{})}),d("div",{className:"next",title:"\u4E0B\u4E00\u9996",onClick:()=>o("next"),children:d(Xt,{})})]})}var ps=h.exports.memo(hs),fs={"other-button":"_other-button_1huph_1"};const gs="_playlist_sthgb_1";var vs={playlist:gs};function ys({isPlaying:e,playlist:n,playingItem:t,currentTime:i}){const{playSong:s,collectSong:l,setPlaylist:o}=h.exports.useContext(ie),[a,c]=h.exports.useState(t.lyric),r=h.exports.useRef(null),u=h.exports.useRef(null),m=h.exports.useRef(null),g=h.exports.useRef(t.id),S=()=>{Fe().delAll(),o([])},y=async C=>{const p=n[C];s(p)},_=(C,p,v)=>{C.stopPropagation(),R().download(p,v)},b=async(C,p)=>{C.stopPropagation();const v=n.slice(),w=v.findIndex(x=>x.id===t.id),N=v.splice(p,1);if(Fe().del(N[0].id),o(v),w===p&&e){const x=v[p]||v[v.length-1];x&&s(x)}},F=(C,p)=>{C.stopPropagation(),l(p)};return it(()=>{if(!toggleList.checked)return;const C=u.current.getElementsByClassName("lyric");if(C.length===0)return;const p=()=>{let A=0,B=C.length-1;for(;A<=B;){const T=A+B>>1,M=Number(C[T].dataset.time);i<M?B=T-1:A=T+1}return A-1};let v;const w=Number(C[0].dataset.time),N=Number(C[C.length-1].dataset.time);if(i>=N)v=C[C.length-1];else{if(i<=w)return;{const A=p();v=C[A]}}if(m.current===v)return;m.current&&m.current.classList.remove("active"),m.current=v,v.classList.add("active");const x=m.current.offsetTop+m.current.scrollHeight/2-195;u.current.scrollTop=x<0?0:x},400),h.exports.useEffect(()=>{t.id!==g.current?(m.current&&m.current.classList.remove("active"),u.current.scrollTop=0,g.current=t.id,c(t.lyric)):t.lyric&&c(t.lyric)},[t]),h.exports.useEffect(()=>{if(r.current){const C=r.current.getContext("2d");R().setCanvasContext(C),R().drawStart()}},[r]),f("div",{className:vs.playlist,children:[d("div",{className:"icon",title:"\u64AD\u653E\u5217\u8868",children:f("label",{htmlFor:"toggleList",children:[d(Kt,{}),n.length]})}),d("input",{type:"checkbox",id:"toggleList",className:"toggle"}),f("div",{className:"list",children:[d("canvas",{ref:r,height:"310",width:"900"}),f("div",{className:"list-left",children:[f("div",{className:"title",children:[f("span",{children:["\u64AD\u653E\u5217\u8868 (",n.length,")"]}),f("span",{className:"clean",onClick:S,children:[d(Ve,{})," \u6E05\u7A7A"]})]}),d("div",{className:"content",children:n.map(({id:C,name:p,singers:v,duration:w},N)=>f("div",{className:C===t.id?"item playing":"item",onClick:()=>y(N),children:[C===t.id&&d(Ue,{}),d("div",{className:"song-title",title:p,children:p}),f("div",{className:"icons",children:[d(st,{title:"\u6DFB\u52A0\u5230\u6B4C\u5355",onClick:x=>F(x,C)}),d(at,{title:"\u4E0B\u8F7D",onClick:x=>_(x,C,p)}),d(Ve,{title:"\u5220\u9664",onClick:x=>b(x,N)})]}),d("div",{className:"singer",title:v.map(({name:x})=>x).join("/"),children:v.map(({name:x})=>x).join("/")}),d("div",{className:"duration",children:ae(w)})]},C))})]}),f("div",{className:"list-right",children:[d("div",{className:"title",children:d("span",{title:t.name,children:t.name})}),f("div",{className:"content",ref:u,children:[a===null&&d("p",{children:"\u6B4C\u8BCD\u52A0\u8F7D\u4E2D..."}),a&&a.length===0&&d("p",{children:"\u6682\u65E0\u6B4C\u8BCD"}),a&&a.map(([C,p,v],w)=>f("p",{"data-time":v,className:"lyric",children:[C,p&&f(xe,{children:[d("br",{}),p]})]},w))]})]}),d("label",{htmlFor:"toggleList",children:d("div",{className:"close",children:"X"})})]})]})}var _s={"play-mode":"_play-mode_txlgz_1"};const Cs={"list-loop":d(Yt,{title:"\u5217\u8868\u5FAA\u73AF"}),random:d(ht,{type:"icon-random",title:"\u968F\u673A"}),"single-cycle":d(ht,{type:"icon-Singlecycle",title:"\u5355\u66F2\u5FAA\u73AF"})};function bs({playMode:e}){const{setPlayMode:n}=h.exports.useContext(ie),t=()=>{let s;e==="list-loop"?s="random":e==="random"?s="single-cycle":s="list-loop",n(s)},i=Cs[e];return d("div",{className:_s["play-mode"],children:d("div",{className:"icon",onClick:t,children:i})})}var ws=h.exports.memo(bs);const Ss="_volume_jlvx2_1";var xs={volume:Ss};function Ns(){const e=n=>{R().setVolume(n*.01)};return f("div",{className:xs.volume,children:[d("div",{className:"icon",title:"\u97F3\u91CF",children:d(Qt,{})}),d("div",{className:"slider",children:d(Zt,{defaultValue:100,onChange:e,tipFormatter:n=>`${n}%`})})]})}var Fs=h.exports.memo(Ns);function As({isPlaying:e,playingItem:n,playlist:t,playMode:i,currentTime:s}){return f("div",{className:fs["other-button"],children:[d(ys,{isPlaying:e,playingItem:n,playlist:t,currentTime:s}),d(ws,{playMode:i}),d(Fs,{})]})}const Es="_progressbar_gqgv7_1";var $s={progressbar:Es};function Ds({playingItem:e,currentTime:n,setCurrentTime:t}){const{duration:i}=e,[s,l]=h.exports.useState(!1),o=h.exports.useRef(null),a=h.exports.useRef(null),{playSong:c}=h.exports.useContext(ie),r=S=>{if(S.button!==0)return;window.addEventListener("mousemove",m),window.addEventListener("mouseup",u),l(!0);const y=window.innerWidth<1e3?1e3:window.innerWidth,_=S.clientX/y;o.current.style.width=`${_*100}%`,a.current.textContent=ae(_*i)},u=S=>{window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",u),l(!1);const y=window.innerWidth<1e3?1e3:window.innerWidth;let b=S.clientX/y*i;b<0?b=0:b>i&&(b=i),t(b),c(e,b)},m=S=>{const y=window.innerWidth<1e3?1e3:window.innerWidth;let _=S.clientX/y;_>1?_=1:_<0&&(_=0),o.current.style.width=`${_*100}%`,a.current.textContent=ae(_*i)},g=h.exports.useMemo(()=>s?{width:o.current.style.width}:{width:`${n/i*100}%`},[n,i]);return f("div",{className:$s.progressbar,children:[d("div",{className:"track",onMouseDown:r}),f("div",{className:"rail",onMouseDown:r,ref:o,style:g,children:[d("div",{className:"handle"}),d("div",{className:"tooltip",ref:a,style:{display:s?"block":"none"}})]})]})}var Is=h.exports.memo(Ds);function Bs(){const e=h.exports.useContext(De),[n,t]=h.exports.useState(0),{isPlaying:i,playMode:s,playlist:l,playingItem:o}=e;return it(()=>{const a=R().getCurrentTime();t(a)},300),f("div",{className:os["music-player"],children:[d(us,{playingItem:o,currentTime:n}),d(ps,{}),d(As,{isPlaying:i,playingItem:o,playlist:l,playMode:s,currentTime:n}),d(Is,{playingItem:o,currentTime:n,setCurrentTime:t})]})}var ks=h.exports.memo(Bs);const Ps="_pagination_vr65g_1";var Ts={pagination:Ps};function Ms({currentPage:e,total:n,pageSize:t,onChange:i}){const s=Math.ceil(n/t);if(s<=1)return null;const l=o=>{if(o==="prev"&&e>1){const a=document.getElementsByClassName(W.right)[0];a.scrollTop=0,i(e-1)}else if(o==="next"&&e<s){const a=document.getElementsByClassName(W.right)[0];a.scrollTop=0,i(e+1)}};return f("div",{className:Ts.pagination,children:[d("div",{className:"page-btn",onClick:()=>l("prev"),children:"<"}),d("div",{className:"page",children:e}),d("div",{className:"page-btn",onClick:()=>l("next"),children:">"})]})}const Ls="_container_r0gt6_1";var Os={container:Ls};function Rs(){const[e,n]=h.exports.useState("Discovery"),{pathname:t}=Re();return h.exports.useEffect(()=>{n(t.slice(1))},[t]),f("div",{className:Os.container,children:[d("input",{type:"checkbox",id:"toggle",className:"input-toggle"}),f("div",{className:"sidebar",children:[d("div",{className:"category",children:"\u63A8\u8350"}),[{text:"\u53D1\u73B0\u97F3\u4E50",Icon:nt,key:"Discovery"},{text:"\u79C1\u4EBAFM",Icon:Jt,key:"PersonalFM"}].map(({key:i,text:s,Icon:l})=>f(k,{className:e===i?"item active":"item",to:`/${i}`,children:[d(l,{})," ",s]},i)),d("div",{className:"category",children:"\u6211\u7684\u97F3\u4E50"}),[{text:"\u6211\u7684\u6B4C\u5355",Icon:rt,key:"MySongList"}].map(({key:i,text:s,Icon:l})=>f(k,{className:e===i?"item active":"item",to:`/${i}`,children:[d(l,{})," ",s]},i)),d("div",{className:"category",children:"GitHub"}),f("a",{className:"item",href:"https://github.com/lisianthus-a/react-music",target:"_blank",children:[d(en,{})," \u9879\u76EE\u5730\u5740"]}),f("a",{className:"item",href:"https://binaryify.github.io/NeteaseCloudMusicApi/#/?id=neteasecloudmusicapi",target:"_blank",children:[d(tn,{})," API\u6587\u6863"]})]}),d("label",{htmlFor:"toggle",children:d("div",{className:"toggle"})})]})}var js=h.exports.memo(Rs);const zs="_songlist_1x4kn_1";var _t={songlist:zs};function Us({songList:e,songIds:n,isCreator:t}){const i=h.exports.useContext(De),{playSong:s,collectSong:l,setPlaylist:o}=h.exports.useContext(ie),a=on("id"),{playingItem:c,playlist:r}=i,[u,m]=h.exports.useState(e||[]),[g,S]=h.exports.useState(1),y=p=>{if(r.find(w=>w.id===p.id))return;const v=r.slice();v.push(p),o(v)},_=p=>{const{id:v,name:w}=p;R().download(v,w)},b=p=>{if(s(p),r.find(w=>w.id===p.id))return;const v=r.slice();v.push(p),o(v)},F=p=>{l(p)},C=p=>{Se.confirm({title:"\u5220\u9664\u6B4C\u66F2",content:`\u662F\u5426\u8981\u5220\u9664\u6B4C\u66F2 ${p.name} \uFF1F`,okText:"\u662F",cancelText:"\u5426",async onOk(){await mt("del",a,p.id),je.success("\u5DF2\u5220\u9664");const v=u.slice(),w=u.findIndex(N=>N.id===p.id);v.splice(w,1),m(v)}})};return h.exports.useEffect(()=>{n&&(async()=>{m([]);const v=(g-1)*50,w=n.slice(v,v+50),N=await ot(w);m(lt(N.songs,"detail"))})()},[n,g]),u.length===0?d(qe,{}):f("div",{className:_t.songlist,children:[f("div",{className:"title",children:["\u6B4C\u66F2\u5217\u8868",f("span",{children:[(e||n).length,"\u9996\u6B4C"]})]}),f("table",{children:[d("thead",{children:f("tr",{children:[d("th",{scope:"col"}),d("th",{scope:"col",children:"\u6B4C\u66F2\u6807\u9898"}),d("th",{scope:"col",children:"\u65F6\u957F"}),d("th",{scope:"col",children:"\u6B4C\u624B"}),d("th",{scope:"col",children:"\u4E13\u8F91"})]})}),d("tbody",{children:u.map((p,v)=>{const{id:w,name:N,singers:x,duration:A,isFree:B,albumId:T,albumName:M}=p;return f("tr",{className:B?void 0:"fee",children:[f("td",{children:[d("span",{children:(g-1)*50+v+1}),d(Ue,{className:c.id===w?"play-btn-playing":"play-btn",onClick:()=>b(p)})]}),f("td",{children:[d(k,{to:`/Song?id=${w}`,title:N,children:N}),f("div",{className:"icons",children:[B&&f(xe,{children:[d(st,{title:"\u6DFB\u52A0\u5230\u64AD\u653E\u5217\u8868",onClick:()=>y(p)}),d(rt,{title:"\u6536\u85CF\u5230\u6B4C\u5355",onClick:()=>F(w)}),d(at,{title:"\u4E0B\u8F7D",onClick:()=>_(p)})]}),t&&d(Ve,{title:"\u5220\u9664",onClick:()=>C(p)})]})]}),d("td",{children:ae(A)}),d("td",{children:x.map(({id:V,name:j},z)=>f(h.exports.Fragment,{children:[d(k,{to:`/Singer?id=${V}`,title:j,className:_t.singer,children:j}),z!==x.length-1&&d("span",{children:" / "})]},z))}),d("td",{children:d(k,{to:`/Album?id=${T}`,title:M,children:M})})]},w)})})]}),d(Ms,{currentPage:g,total:(n==null?void 0:n.length)||0,pageSize:50,onChange:S})]})}var ua=h.exports.memo(Us);const Vs="_tabs_1cb5f_1",Hs="_tab_1cb5f_1";var Xe={tabs:Vs,tab:Hs,"tab-active":"_tab-active_1cb5f_9"};function qs({children:e,onChange:n}){const t=h.exports.useMemo(()=>{const l=[];return be.Children.forEach(e,o=>{be.isValidElement(o)&&l.push({key:o.key,text:o.props.text,element:o})}),l},[e]),[i,s]=h.exports.useState(t[0].key);return f(xe,{children:[d("div",{className:Xe.tabs,children:t.map(({key:l,text:o})=>d("div",{className:i===l?Xe["tab-active"]:Xe.tab,onClick:()=>{s(l),n&&n(l)},children:o},l))}),t.filter(l=>l.key===i)[0].element]})}function Ws(e){return e.children}qs.Pane=Ws;const Gs="modulepreload",Ct={},Xs="/react-music/",U=function(n,t){return!t||t.length===0?n():Promise.all(t.map(i=>{if(i=`${Xs}${i}`,i in Ct)return;Ct[i]=!0;const s=i.endsWith(".css"),l=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${l}`))return;const o=document.createElement("link");if(o.rel=s?"stylesheet":Gs,s||(o.as="script",o.crossOrigin=""),o.href=i,document.head.appendChild(o),s)return new Promise((a,c)=>{o.addEventListener("load",a),o.addEventListener("error",c)})})).then(()=>n())};var Ks=[{isDynamic:!1,path:"/Album",component:()=>U(()=>import("./index.1f624d6c.js"),["assets/index.1f624d6c.js","assets/index.88dbd4ba.css","assets/vendor.47a03c39.js","assets/index.84cf9ca7.js"])},{isDynamic:!1,path:"/Discovery",component:()=>U(()=>import("./index.51b191b1.js"),["assets/index.51b191b1.js","assets/index.218aba9a.css","assets/vendor.47a03c39.js"])},{isDynamic:!1,path:"/MySongList",component:()=>U(()=>import("./index.1426f57b.js"),["assets/index.1426f57b.js","assets/index.72357c03.css","assets/vendor.47a03c39.js"])},{isDynamic:!1,path:"/PersonalFM",component:()=>U(()=>import("./index.93dfe2d2.js"),["assets/index.93dfe2d2.js","assets/index.bd36bfc0.css","assets/vendor.47a03c39.js"])},{isDynamic:!1,path:"/Playlist",component:()=>U(()=>import("./index.9d13cdd4.js"),["assets/index.9d13cdd4.js","assets/index.51c499bb.css","assets/vendor.47a03c39.js","assets/index.84cf9ca7.js"])},{isDynamic:!1,path:"/Search",component:()=>U(()=>import("./index.b52acf33.js"),["assets/index.b52acf33.js","assets/index.8a5e2951.css","assets/vendor.47a03c39.js"])},{isDynamic:!1,path:"/Singer",component:()=>U(()=>import("./index.c0bc5c1c.js"),["assets/index.c0bc5c1c.js","assets/index.42fb7331.css","assets/vendor.47a03c39.js"])},{isDynamic:!1,path:"/Song",component:()=>U(()=>import("./index.2003a258.js"),["assets/index.2003a258.js","assets/index.fb0015a2.css","assets/vendor.47a03c39.js","assets/index.84cf9ca7.js"])},{isDynamic:!1,path:"/User",component:()=>U(()=>import("./index.8e920f98.js"),["assets/index.8e920f98.js","assets/vendor.47a03c39.js"])},{isDynamic:!1,path:"/Video",component:()=>U(()=>import("./index.92aa1e47.js"),["assets/index.92aa1e47.js","assets/vendor.47a03c39.js"])}];const bt={},Ke={};Ks.forEach(e=>{const{path:n,isDynamic:t}=e;t?Ke[n]=e:bt[n]=e});function Ys(){const e=tt(),n=Re(),[t,i]=h.exports.useState(null),[s,l]=h.exports.useState({}),[o,a]=h.exports.useState({});return h.exports.useEffect(()=>{const{search:c,pathname:r}=n,m=(c.match(/[?&]([^?&]+)=([^?&]+)/g)||[]).reduce((S,y)=>{const[_,b]=y.slice(1).split("=");return S[_]=b,S},{});l(m);const g=bt[r]||null;if(g){i(h.exports.lazy(g.component)),a({});return}for(const S in Ke){const{path:y,component:_}=Ke[S],b=(y.match(/\[[^\/]+\]/g)||[]).map(p=>p.slice(1,-1)),F=new RegExp(y.replace(/\[[^\/]+\]/g,"([^/]+)")),C=(r.match(F)||[]).slice(1);if(b.length===C.length){const p={};for(let v=0;v<b.length;++v){const w=b[v],N=C[v];p[w]=N}i(h.exports.lazy(_)),a(p);return}}e("/Discovery")},[n]),t?d(h.exports.Suspense,{fallback:d(qe,{}),children:d(t,{query:s,pageParams:o})}):null}const wt={id:776039,name:"ONE's hope",singers:[{id:18303,name:"\u3084\u306A\u304E\u306A\u304E"}],duration:369.72,cover:"https://p1.music.126.net/l22TRH7bs4VG6HMT2Iy56w==/2511284557902801.jpg",isFree:!0,albumId:76484,albumName:"Colorful Parade"},St={isPlaying:!1,playlist:[wt],playMode:"list-loop",playingItem:q(O({},wt),{lyric:null})},De=be.createContext(St),ie=be.createContext(null),xt=document.getElementById("audio");function Qs(){const[e,n]=rn(St),t=h.exports.useMemo(()=>({getSong:(r,u)=>{const{playlist:m,playingItem:g,playMode:S}=u,y=m.length;if(y<=1||S==="single-cycle")return g;const _=m.findIndex(({id:F})=>F===g.id);let b;switch(S){case"list-loop":b=r==="next"?(_+1)%y:(y+_-1)%y;break;case"random":b=Math.random()*y>>0,b===_&&(b=(_+1)%y)}return m[b]},playSong:(r,u)=>{const{id:m}=r;n({isPlaying:!0,playingItem:q(O({},r),{lyric:null})}),R().play(m,u).then(g=>{g?(xt.play(),n({playingItem:R().getPlayingItem()})):je.error(`\u52A0\u8F7D\u6B4C\u66F2\u5931\u8D25\uFF0Cid:${m}`)})},collectSong:r=>{Se.info({title:"\u6536\u85CF\u6B4C\u66F2",maskClosable:!0,okButtonProps:{style:{display:"none"}},width:500,content:d(Mn,{id:r})})},pauseSong:()=>{xt.pause(),R().pause(),n({isPlaying:!1})},setPlaylist:r=>{n({playlist:r})},setPlayMode:r=>{n({playMode:r})}}),[]);return h.exports.useEffect(()=>{if(!navigator.mediaSession||!MediaMetadata||!e.playingItem)return;const{name:i,singers:s,cover:l,albumName:o}=e.playingItem;navigator.mediaSession.metadata=new MediaMetadata({title:i,artist:s.map(a=>a.name).join("/"),album:o,artwork:[{src:`${l}?param=96y96`,sizes:"96x96",type:"image/jpeg"},{src:`${l}?param=128y128`,sizes:"128x128",type:"image/jpeg"},{src:`${l}?param=192y192`,sizes:"192x192",type:"image/jpeg"},{src:`${l}?param=256y256`,sizes:"256x256",type:"image/jpeg"},{src:`${l}?param=384y384`,sizes:"384x384",type:"image/jpeg"},{src:`${l}?param=512y512`,sizes:"512x512",type:"image/jpeg"}]})},[e]),h.exports.useEffect(()=>{!navigator.mediaSession||!MediaMetadata||(navigator.mediaSession.setActionHandler("play",()=>{const{playingItem:i}=e;t.playSong(i)}),navigator.mediaSession.setActionHandler("pause",()=>{t.pauseSong()}),navigator.mediaSession.setActionHandler("previoustrack",()=>{const i=t.getSong("prev",e);t.playSong(i)}),navigator.mediaSession.setActionHandler("nexttrack",()=>{const i=t.getSong("next",e);t.playSong(i)}))},[e]),h.exports.useEffect(()=>{R().setOnEnded(()=>{const{getSong:i,playSong:s}=t,l=i("next",e);s(l)})},[e]),d(ie.Provider,{value:t,children:d(De.Provider,{value:e,children:d(kn,{children:d(Ys,{})})})})}const Zs="/react-music";function Js(){return d(nn,{basename:Zs,children:d(Qs,{})})}sn.render(d(be.StrictMode,{children:d(Js,{})}),document.getElementById("root"));export{oa as C,ie as F,qe as L,Ms as P,ua as S,qs as T,P as a,lt as b,Fe as c,De as d,la as e,it as f,H as g,fn as h,hn as i,ia as j,Tn as k,W as l,R as m,ae as n,ra as o,aa as p,rs as q,sa as r,ot as s,rn as t,on as u,ca as v,mn as w,vn as x,na as y};
